<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Markdown 首行缩进</title>
    <url>/posts/2019-04-28/19923/</url>
    <content><![CDATA[<h2 id="Markdown-首行缩进"><a href="#Markdown-首行缩进" class="headerlink" title="Markdown 首行缩进"></a>Markdown 首行缩进</h2><blockquote>
<p>在中文书写时我们通常习惯段首缩进两个字，但是使用markdown编辑时我们手打空格缩进是不起效果的，因此我们需要通过使用HTML中的空格实体来帮助我们实现缩进效果。</p>
</blockquote>
<h3 id="markdowm首行缩进方法-有如下几种方法："><a href="#markdowm首行缩进方法-有如下几种方法：" class="headerlink" title="markdowm首行缩进方法,有如下几种方法："></a>markdowm首行缩进方法,有如下几种方法：</h3><blockquote>
<p>一个汉字占两个空格大小，所以使用四个空格就可以达到首行缩进两个汉字的效果。</p>
</blockquote>
<ul>
<li>一个空格大小的表示：**<code>&amp;ensp;</code>** 或 <strong><code>&amp;#8194;</code></strong> ，此时只要在相应需要缩进的段落前加上 4个 如上的标记即可，注意要带上分号。</li>
<li>两个空格的大小表示：**<code>&amp;emsp;</code>** 或 <strong><code>&amp;#8195;</code></strong> ，同理，使用2个即可缩进2个汉字，推荐使用该方式。</li>
<li>不换行空格：**<code>&amp;nbsp;</code>** 或 <strong><code>&amp;#160;</code></strong> ，使用4个 <strong><code>&amp;#160;</code></strong> 即可。</li>
</ul>
]]></content>
      <tags>
        <tag>markdown</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>V2ray</title>
    <url>/posts/2019-09-06/56590/</url>
    <content><![CDATA[<h1 id="V2ray"><a href="#V2ray" class="headerlink" title="V2ray"></a>V2ray</h1><h2 id="获取安装包"><a href="#获取安装包" class="headerlink" title="获取安装包"></a>获取安装包</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://install.direct/go.sh</span><br></pre></td></tr></table></figure>

<h2 id="执行安装命令"><a href="#执行安装命令" class="headerlink" title="执行安装命令"></a>执行安装命令</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo bash go.sh</span><br></pre></td></tr></table></figure>

<h2 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 启动</span></span><br><span class="line">sudo systemctl start v2ray</span><br><span class="line"></span><br><span class="line"><span class="comment">## 停止</span></span><br><span class="line">sudo systemctl stop v2ray</span><br><span class="line"></span><br><span class="line"><span class="comment">## 重启</span></span><br><span class="line">sudo systemctl restart v2ray</span><br><span class="line"></span><br><span class="line"><span class="comment">## 状态</span></span><br><span class="line">service v2ray status</span><br></pre></td></tr></table></figure>
<span id="more"></span>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>配置路径：&#x2F;etc&#x2F;v2ray&#x2F;config.json</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看配置</span></span><br><span class="line"><span class="built_in">cat</span> /etc/v2ray/config.json</span><br><span class="line"><span class="comment"># 修改配置</span></span><br><span class="line">vi /etc/v2ray/config.json</span><br></pre></td></tr></table></figure>

<h3 id="BBR加速"><a href="#BBR加速" class="headerlink" title="BBR加速"></a>BBR加速</h3><p>内核需要在4.10之上，而我用的是centos8，满足条件<br>修改&#x2F;etc&#x2F;sysctl.conf文件</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 增加下面两行代码</span></span><br><span class="line"><span class="attr">net.core.default_qdisc</span>=<span class="string">fq</span></span><br><span class="line"><span class="attr">net.ipv4.tcp_congestion_control</span>=<span class="string">bbr</span></span><br></pre></td></tr></table></figure>

<p>验证：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sysctl net.ipv4.tcp_available_congestion_control</span></span><br><span class="line">net.ipv4.tcp_available_congestion_control = bbr cubic reno</span><br><span class="line"><span class="comment"># lsmod | grep bbr</span></span><br><span class="line">  tcp_bbr                16384  3</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>Java21 SpringBoot3.2.x GraalVM Docker 初探</title>
    <url>/posts/2023-04-17/1/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>Java21 正式引入虚拟线程特性，SpringBoot 3.2.x 也支持了该特性，今天来测试一下，顺便复习一下 GraalVM 和 Docker 镜像构建</p>
</blockquote>
<h2 id="工程搭建"><a href="#工程搭建" class="headerlink" title="工程搭建"></a>工程搭建</h2><h3 id="Idea-Spring-项目初始化"><a href="#Idea-Spring-项目初始化" class="headerlink" title="Idea Spring 项目初始化"></a>Idea Spring 项目初始化</h3><ul>
<li>父项目</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>
<span id="more"></span>
<ul>
<li>项目属性</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>21<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skipTests</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>项目依赖</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>构建插件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">exclude</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>构建插件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>native<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.graalvm.buildtools<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>native-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">extensions</span>&gt;</span>true<span class="tag">&lt;/<span class="name">extensions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">id</span>&gt;</span>build-native<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>compile-no-fork<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">id</span>&gt;</span>test-native<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>test<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">buildArgs</span>&gt;</span></span><br><span class="line">                            <span class="comment">&lt;!--&lt;mainClass&gt;org.example.demo02.Demo02Application&lt;/mainClass&gt;</span></span><br><span class="line"><span class="comment">                            &lt;imageName&gt;$&#123;project.artifactId&#125;&lt;/imageName&gt;</span></span><br><span class="line"><span class="comment">                            &lt;arg&gt;-H:+ReportExceptionStackTraces&lt;/arg&gt;--&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">arg</span>&gt;</span>-H:+UnlockExperimentalVMOptions<span class="tag">&lt;/<span class="name">arg</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">arg</span>&gt;</span>-H:-CheckToolchain<span class="tag">&lt;/<span class="name">arg</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">buildArgs</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>配置文件</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">    <span class="attr">threads:</span></span><br><span class="line">        <span class="attr">virtual:</span></span><br><span class="line">            <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="项目代码"><a href="#项目代码" class="headerlink" title="项目代码"></a>项目代码</h3><ul>
<li>启动类</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="meta">@EnableScheduling</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo02Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Demo02Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>控制层</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AsyncTaskExecutorService taskExecutorService;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hi&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">()</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;Rest controller method has been called &#123;&#125;&quot;</span>, Thread.currentThread());</span><br><span class="line">        taskExecutorService.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AsyncTaskExecutorService</span> &#123;</span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;Async task method has been called &#123;&#125;&quot;</span>, Thread.currentThread());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SchedulerService</span> &#123;</span><br><span class="line">    <span class="meta">@Scheduled(fixedDelayString = &quot;15000&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;Scheduled method has been called &#123;&#125;&quot;</span>, Thread.currentThread());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><p>浏览器访问 <a href="http://127..0.0.1:8080/test/hi">接口</a> ，控制台打印信息如下，可以看到 <strong>VirtualThread</strong> 虚拟线程开启成功</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  .   ____          _            __ _ _</span><br><span class="line"> /\\ / ___&#x27;_ __ _ _(_)_ __  __ _ \ \ \ \</span><br><span class="line">( ( )\___ | &#x27;_ | &#x27;_| | &#x27;_ \/ _` | \ \ \ \</span><br><span class="line"> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )</span><br><span class="line">  &#x27;  |____| .__|_| |_|_| |_\__, | / / / /</span><br><span class="line"> =========|_|==============|___/=/_/_/_/</span><br><span class="line"> :: Spring Boot ::                (v3.2.1)</span><br><span class="line"></span><br><span class="line">2023-12-29T16:46:05.999+08:00  INFO 44632 --- [           main] org.example.demo02.Demo02Application     : Starting Demo02Application using Java 21.0.1 with PID 44632 (D:\Project\GraalVM\demo02\target\classes started by esafenet in D:\Project\GraalVM\demo02)</span><br><span class="line">2023-12-29T16:46:06.001+08:00  INFO 44632 --- [           main] org.example.demo02.Demo02Application     : No active profile set, falling back to 1 default profile: &quot;default&quot;</span><br><span class="line">2023-12-29T16:46:06.766+08:00  INFO 44632 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)</span><br><span class="line">2023-12-29T16:46:06.778+08:00  INFO 44632 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]</span><br><span class="line">2023-12-29T16:46:06.778+08:00  INFO 44632 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.17]</span><br><span class="line">2023-12-29T16:46:06.827+08:00  INFO 44632 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext</span><br><span class="line">2023-12-29T16:46:06.828+08:00  INFO 44632 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 789 ms</span><br><span class="line">2023-12-29T16:46:07.189+08:00  INFO 44632 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path &#x27;&#x27;</span><br><span class="line">2023-12-29T16:46:07.198+08:00  INFO 44632 --- [           main] org.example.demo02.Demo02Application     : Started Demo02Application in 1.537 seconds (process running for 2.27)</span><br><span class="line">2023-12-29T16:46:07.205+08:00  INFO 44632 --- [   scheduling-1] o.example.demo02.task.SchedulerService   : Scheduled method has been called VirtualThread[#43,scheduling-1]/runnable@ForkJoinPool-1-worker-1</span><br><span class="line">2023-12-29T16:46:21.132+08:00  INFO 44632 --- [omcat-handler-0] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet &#x27;dispatcherServlet&#x27;</span><br><span class="line">2023-12-29T16:46:21.132+08:00  INFO 44632 --- [omcat-handler-0] o.s.web.servlet.DispatcherServlet        : Initializing Servlet &#x27;dispatcherServlet&#x27;</span><br><span class="line">2023-12-29T16:46:21.133+08:00  INFO 44632 --- [omcat-handler-0] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms</span><br><span class="line">2023-12-29T16:46:22.211+08:00  INFO 44632 --- [   scheduling-1] o.example.demo02.task.SchedulerService   : Scheduled method has been called VirtualThread[#43,scheduling-1]/runnable@ForkJoinPool-1-worker-1</span><br><span class="line">2023-12-29T16:46:25.503+08:00  INFO 44632 --- [omcat-handler-2] org.example.demo02.web.TestController    : Rest controller method has been called VirtualThread[#53,tomcat-handler-2]/runnable@ForkJoinPool-1-worker-1</span><br><span class="line">2023-12-29T16:46:25.510+08:00  INFO 44632 --- [         task-1] o.e.d.service.AsyncTaskExecutorService   : Async task method has been called VirtualThread[#54,task-1]/runnable@ForkJoinPool-1-worker-3</span><br></pre></td></tr></table></figure>

<h3 id="GraalVM-项目构建"><a href="#GraalVM-项目构建" class="headerlink" title="GraalVM 项目构建"></a>GraalVM 项目构建</h3><p>执行下面的命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mvn -Pnative -DskipTests -DskipNativeTests clean package</span><br></pre></td></tr></table></figure>

<p>项目根目录 target 下则出现了 demo02.exe，直接双击启动，一闪而过的话大概率是端口被占用，启动速度相当快 <strong>Started Demo02Application in 0.15 seconds</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Produced artifacts:</span><br><span class="line"> D:\Project\GraalVM\demo02\target\demo02.exe (executable)</span><br><span class="line">========================================================================================================================</span><br><span class="line">Finished generating &#x27;demo02&#x27; in 1m 39s.</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total time:  01:52 min</span><br><span class="line">[INFO] Finished at: 2023-12-29T16:55:31+08:00</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<h3 id="GraalVM-构建-Docker-镜像"><a href="#GraalVM-构建-Docker-镜像" class="headerlink" title="GraalVM 构建 Docker 镜像"></a>GraalVM 构建 Docker 镜像</h3><p>执行下面的命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mvn -Pnative -DskipTests -DskipNativeTests clean spring-boot:build-image</span><br></pre></td></tr></table></figure>

<p>如果构建慢，可以提前拉取这两个镜像</p>
<ul>
<li>paketobuildpacks&#x2F;run-jammy-tiny:latest</li>
<li>paketobuildpacks&#x2F;builder-jammy-tiny:latest</li>
</ul>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.graalvm.org/latest/guides/">graalvm guides</a><br><a href="https://graalvm.github.io/native-build-tools/latest/maven-plugin.html">graalvm maven plugin</a><br><a href="https://learn.microsoft.com/en-us/visualstudio/releases/2022/release-notes">visualstudio2022</a><br><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/native-image.html">spring boot native image</a><br><a href="https://springdoc.cn/java-graalvm-docker-image/">spring doc 中文 java-graalvm-docker-image</a><br><a href="https://springdoc.cn/spring-native-intro/">spring doc 中文 spring-native-intro</a><br><a href="https://zhuanlan.zhihu.com/p/297971991">image build三种对比</a><br><a href="https://github.com/spring-projects/spring-boot/blob/main/spring-boot-project/spring-boot-tools/spring-boot-maven-plugin/src/main/java/org/springframework/boot/maven/BuildImageMojo.java">spring boot build image plugin</a></p>
]]></content>
      <tags>
        <tag>spring boot</tag>
        <tag>Java21</tag>
        <tag>GraalVM</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo 部署到github或gitee</title>
    <url>/posts/2019-04-23/33295/</url>
    <content><![CDATA[<h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><h2 id="Hexo提供快速简便的部署策略，只需要一个命令即可将站点部署到服务器。"><a href="#Hexo提供快速简便的部署策略，只需要一个命令即可将站点部署到服务器。" class="headerlink" title="Hexo提供快速简便的部署策略，只需要一个命令即可将站点部署到服务器。"></a>Hexo提供快速简便的部署策略，只需要一个命令即可将站点部署到服务器。</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 也可以简写为</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<h2 id="首先添加依赖hexo-deployer-git"><a href="#首先添加依赖hexo-deployer-git" class="headerlink" title="首先添加依赖hexo-deployer-git"></a>首先添加依赖hexo-deployer-git</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<h2 id="部署之前修改项目根目录下的-config-yml"><a href="#部署之前修改项目根目录下的-config-yml" class="headerlink" title="部署之前修改项目根目录下的_config.yml"></a>部署之前修改项目根目录下的_config.yml</h2><span id="more"></span>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://github.com/jackkke/jackkke.github.io.git</span><br><span class="line">  branch: master</span><br><span class="line">  <span class="comment"># message：</span></span><br></pre></td></tr></table></figure>

<p>可以同时部署到多个环境，Hexo将按顺序执行</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">- <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://github.com/jackkke/jackkke.github.io.git</span><br><span class="line">  branch: master</span><br><span class="line">  <span class="comment"># message：</span></span><br><span class="line">- <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://gitee.com/jackkke/jackkke.git</span><br><span class="line">  branch: master</span><br><span class="line">  <span class="comment"># message：</span></span><br></pre></td></tr></table></figure>

<h2 id="参数介绍"><a href="#参数介绍" class="headerlink" title="参数介绍"></a>参数介绍</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">repo: GitHub / Bitbucket / Coding / GitLab / Gitee存储库URL</span><br><span class="line">branch: 分支名称</span><br><span class="line">message: 默认为Site updated: &#123;&#123; now(<span class="string">&#x27;YYYY-MM-DD HH:mm:ss&#x27;</span>) &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="建议部署方式"><a href="#建议部署方式" class="headerlink" title="建议部署方式"></a>建议部署方式</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 前者清除站点文件，后者重新生成站点文件并将之推送到指定的库分支。</span></span><br><span class="line">hexo clean &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>

<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-17/26406/">Hexo + GitHub Pages搭建博客</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-17/24134/">优化NexT 6.0版本</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-23/33295/">Hexo 部署到github或gitee</a></li></ul></div>]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo 6.x结合Next 8.x搭建（一）</title>
    <url>/posts/2022-09-02/21358/</url>
    <content><![CDATA[<h3 id="Hexo配置"><a href="#Hexo配置" class="headerlink" title="Hexo配置"></a>Hexo配置</h3><p><a href="https://theme-next.js.org/docs/getting-started/">Next官方文档</a><br>里面啥都有，看完之后不需要再往下看，下面仅为个人搭建过程备份。</p>
<span id="more"></span>
<h3 id="网站基础信息修改"><a href="#网站基础信息修改" class="headerlink" title="网站基础信息修改"></a>网站基础信息修改</h3><figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Just</span> <span class="string">Do</span> <span class="string">IT</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">开心抄代码</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">爱编码、爱做饭、爱你</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">jackkke</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span></span><br></pre></td></tr></table></figure>

<h3 id="站点url配置"><a href="#站点url配置" class="headerlink" title="站点url配置"></a>站点url配置</h3><p><a href="https://github.com/rozbo/hexo-abbrlink">Github 链接</a></p>
<figure class="highlight shell"><figcaption><span>文章链接短链支持插件安装</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm install hexo-abbrlink</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：如果你的<strong>projectname</strong>非username.github.io形式, root则需要加上你的<strong>projectname</strong></p>
</blockquote>
<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="string">https://jackkke.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:year-:month-:day/:abbrlink/</span></span><br></pre></td></tr></table></figure>

<h3 id="跳过页面编译"><a href="#跳过页面编译" class="headerlink" title="跳过页面编译"></a>跳过页面编译</h3><p>使用腾讯云cdn加速需要以下配置</p>
<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">skip_render:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">verification.html</span></span><br></pre></td></tr></table></figure>

<h3 id="主题指定"><a href="#主题指定" class="headerlink" title="主题指定"></a>主题指定</h3><p><a href="https://github.com/next-theme/hexo-theme-next">Github 链接</a></p>
<figure class="highlight powershell"><figcaption><span>移除默认主题，增加next主题</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> npm uninstall hexo<span class="literal">-theme-landscape</span></span><br><span class="line"><span class="variable">$</span> npm install hexo<span class="literal">-theme-next</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure>

<figure class="highlight text"><figcaption><span>复制一份默认配置到根目录，并重命名</span></figcaption><table><tr><td class="code"><pre><span class="line">cp blog\node_modules\hexo-theme-next\_config.yml blog\_config.next.yml</span><br></pre></td></tr></table></figure>

<h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><p><a href="https://github.com/hexojs/hexo-deployer-git">Github 链接</a></p>
<figure class="highlight powershell"><figcaption><span>git部署</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> npm install hexo<span class="literal">-deployer-git</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">git@github.com:jackkke/jackkke.github.io.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">git@gitee.com:jackkke/jackkke.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<h3 id="自动部署"><a href="#自动部署" class="headerlink" title="自动部署"></a>自动部署</h3><p><a href="">Github 链接</a></p>
<ul>
<li>HEXO_GITHUB_PRIVATE_KEY 这个是github和gitee的sshkey，需要添加到项目的secrets</li>
<li>GITEE_PASSWORD 这个是gitee的密码，gitee部署后需要手动更新，使用脚本进行自动部署”最后一公里”</li>
<li>密钥添加链接<code>https://github.com/jackkke/blog/settings/secrets/actions</code></li>
</ul>
<figure class="highlight yaml"><figcaption><span>blog\.github\workflows\main.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">CI</span> <span class="string">Hexo</span> <span class="string">Blog</span> <span class="string">Deploy</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line">  <span class="comment"># Allows you to run this workflow manually from the Actions tab</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">Repository</span> <span class="string">master</span> <span class="string">branch</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">      <span class="comment"># from: https://github.com/actions/setup-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span>  <span class="string">Setup</span> <span class="string">Node.js</span> <span class="number">16.</span><span class="string">x</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@master</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&quot;16.x&quot;</span></span><br><span class="line">      <span class="comment"># Runs a set of commands using the runners shell</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">a</span> <span class="string">multi-line</span> <span class="string">script</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install hexo-cli -g</span></span><br><span class="line"><span class="string">          npm install</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Deploy</span> <span class="string">Private</span> <span class="string">Key</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">HEXO_GITHUB_PRIVATE_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HEXO_GITHUB_PRIVATE_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          mkdir -p ~/.ssh/</span></span><br><span class="line"><span class="string">          echo &quot;$HEXO_GITHUB_PRIVATE_KEY&quot; &gt; ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">          chmod 600 ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">          ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span></span><br><span class="line"><span class="string">          ssh-keyscan gitee.com &gt;&gt; ~/.ssh/known_hosts</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Git</span> <span class="string">Infomation</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          git config --global user.name &#x27;jackkke&#x27;</span></span><br><span class="line"><span class="string">          git config --global user.email &#x27;hangao1204@hotmail.com&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string">          hexo deploy</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">Gitee</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">yanglbme/gitee-pages-action@main</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">gitee-username:</span> <span class="string">jackkke</span></span><br><span class="line">          <span class="attr">gitee-password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITEE_PASSWORD</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">gitee-repo:</span> <span class="string">jackkke</span></span><br><span class="line">          <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<h3 id="本地搜索"><a href="#本地搜索" class="headerlink" title="本地搜索"></a>本地搜索</h3><p><a href="https://github.com/next-theme/hexo-generator-searchdb">Github 链接</a></p>
<figure class="highlight powershell"><figcaption><span>搜索本地支持</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> npm install hexo<span class="literal">-generator-searchdb</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br></pre></td></tr></table></figure>

<h3 id="字数统计"><a href="#字数统计" class="headerlink" title="字数统计"></a>字数统计</h3><p><a href="https://github.com/next-theme/hexo-word-counter">Github 链接</a></p>
<figure class="highlight powershell"><figcaption><span>字数统计、阅读时间统计</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> npm install hexo<span class="literal">-word-counter</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">awl:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">200</span></span><br></pre></td></tr></table></figure>

<h3 id="系列文章"><a href="#系列文章" class="headerlink" title="系列文章"></a>系列文章</h3><p><a href="https://github.com/r12f/hexo-post-series">Github 链接</a></p>
<figure class="highlight powershell"><figcaption><span>系列文章</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> npm install hexo<span class="literal">-post-series</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">post_series:</span></span><br><span class="line">  <span class="attr">list_title:</span> <span class="string">&quot;系列文章&quot;</span></span><br><span class="line">  <span class="attr">open_in_new_tab:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">reverse_sort:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="网站压缩"><a href="#网站压缩" class="headerlink" title="网站压缩"></a>网站压缩</h3><p><a href="https://github.com/rozbo/hexo-neat">Github 链接</a></p>
<figure class="highlight powershell"><figcaption><span>文章压缩</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> npm install hexo<span class="literal">-neat</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="string">neat_enable</span></span><br></pre></td></tr></table></figure>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-09-02/21358/">Hexo 6.x结合Next 8.x搭建（一）</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-09-02/21359/">Hexo 6.x结合Next 8.x搭建（二）</a></li></ul></div>
]]></content>
      <tags>
        <tag>hexo</tag>
        <tag>next</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo 6.x结合Next 8.x搭建（二）</title>
    <url>/posts/2022-09-02/21359/</url>
    <content><![CDATA[<h3 id="Next配置"><a href="#Next配置" class="headerlink" title="Next配置"></a>Next配置</h3><p><a href="https://theme-next.js.org/docs/getting-started/">Next官方文档</a><br>里面啥都有，看完之后不需要再往下看，下面仅为个人搭建过程备份。</p>
<span id="more"></span>
<h3 id="生成静态页面后移除非必要文件"><a href="#生成静态页面后移除非必要文件" class="headerlink" title="生成静态页面后移除非必要文件"></a>生成静态页面后移除非必要文件</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Remove unnecessary files after hexo generate.</span></span><br><span class="line"><span class="attr">minify:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="自定义样式"><a href="#自定义样式" class="headerlink" title="自定义样式"></a>自定义样式</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Define custom file paths.</span></span><br><span class="line"><span class="comment"># Create your custom files in site directory `source/_data` and uncomment needed files below.</span></span><br><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="comment">#head: source/_data/head.njk</span></span><br><span class="line">  <span class="comment">#header: source/_data/header.njk</span></span><br><span class="line">  <span class="comment">#sidebar: source/_data/sidebar.njk</span></span><br><span class="line">  <span class="comment">#postMeta: source/_data/post-meta.njk</span></span><br><span class="line">  <span class="comment">#postBodyEnd: source/_data/post-body-end.njk</span></span><br><span class="line">  <span class="comment">#footer: source/_data/footer.njk</span></span><br><span class="line">  <span class="comment">#bodyEnd: source/_data/body-end.njk</span></span><br><span class="line">  <span class="attr">variable:</span> <span class="string">source/_data/variables.styl</span></span><br><span class="line">  <span class="comment">#mixin: source/_data/mixins.styl</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">source/_data/styles.styl</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><figcaption><span>source/_data/styles.styl</span></figcaption><table><tr><td class="code"><pre><span class="line">// 页面最大宽度</span><br><span class="line">//<span class="keyword">@media</span> (<span class="attribute">min-width</span>: <span class="number">1600px</span>) &#123;</span><br><span class="line">//  <span class="selector-class">.main</span> &#123;</span><br><span class="line">//    <span class="attribute">max-width</span>: <span class="number">1440px</span>;</span><br><span class="line">//  &#125;</span><br><span class="line">//&#125;</span><br><span class="line"></span><br><span class="line">// 圆角</span><br><span class="line"><span class="selector-class">.site-brand-container</span> &#123;</span><br><span class="line">  <span class="attribute">border-top-right-radius</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">border-top-left-radius</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 顶部留空白</span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 顶部留空白</span><br><span class="line"><span class="selector-class">.main-inner</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 系列文章样式自定义</span><br><span class="line"><span class="selector-class">.post-series</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1em</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 系列文章样式自定义</span><br><span class="line"><span class="selector-class">.post-series-title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.25em</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">&#125;</span><br><span class="line">// 顶部黑条不显示</span><br><span class="line"><span class="selector-class">.headband</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><figcaption><span>source/_data/variables.styl</span></figcaption><table><tr><td class="code"><pre><span class="line">// 内容最大宽度</span><br><span class="line">//$<span class="attribute">content</span>-desktop-largest = <span class="number">95%</span></span><br><span class="line">// 圆角</span><br><span class="line">$<span class="attribute">border-radius</span>-inner = <span class="number">16px</span></span><br><span class="line">$<span class="attribute">border-radius</span> = <span class="number">16px</span></span><br><span class="line">$btn-default-radius = <span class="number">16px</span></span><br></pre></td></tr></table></figure>

<h3 id="主题风格切换"><a href="#主题风格切换" class="headerlink" title="主题风格切换"></a>主题风格切换</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment">#scheme: Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br></pre></td></tr></table></figure>

<h3 id="夜间模式"><a href="#夜间模式" class="headerlink" title="夜间模式"></a>夜间模式</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dark Mode</span></span><br><span class="line"><span class="attr">darkmode:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="网站图标"><a href="#网站图标" class="headerlink" title="网站图标"></a>网站图标</h3><p><a href="https://www.qiniu.com/">七牛云图床</a><br>待补充使用教程</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">small:</span> <span class="string">http://cdn.jackkke.top/blog/images/favicon-16x16-next_j.png</span></span><br><span class="line">  <span class="attr">medium:</span> <span class="string">http://cdn.jackkke.top/blog/images/favicon-32x32-next_j.png</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">http://cdn.jackkke.top/blog/images/apple-touch-icon-next_j.png</span></span><br><span class="line">  <span class="attr">safari_pinned_tab:</span> <span class="string">http://cdn.jackkke.top/blog/images/logo.svg</span></span><br><span class="line">  <span class="comment">#android_manifest: /manifest.json</span></span><br></pre></td></tr></table></figure>

<h3 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明"></a>版权声明</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="comment"># Available values: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | cc-zero</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="comment"># Available values: big | small</span></span><br><span class="line">  <span class="attr">size:</span> <span class="string">small</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># You can set a language value if you prefer a translated version of CC license, e.g. deed.zh</span></span><br><span class="line">  <span class="comment"># CC licenses are available in 39 languages, you can find the specific and correct abbreviation you need on https://creativecommons.org</span></span><br><span class="line">  <span class="attr">language:</span> <span class="string">deed.zh</span></span><br></pre></td></tr></table></figure>

<h3 id="菜单配置"><a href="#菜单配置" class="headerlink" title="菜单配置"></a>菜单配置</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="attr">schedule:</span> <span class="string">/schedule/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-calendar</span></span><br><span class="line">  <span class="attr">sitemap:</span> <span class="string">/sitemap.xml</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-sitemap</span></span><br><span class="line">  <span class="attr">commonweal:</span> <span class="string">/404/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-heartbeat</span></span><br><span class="line">  <span class="string">我的导航:</span> <span class="string">/nav/</span> <span class="string">||</span> <span class="string">fa</span>  <span class="string">fa-compass</span></span><br></pre></td></tr></table></figure>

<h3 id="侧边栏显示文章数量"><a href="#侧边栏显示文章数量" class="headerlink" title="侧边栏显示文章数量"></a>侧边栏显示文章数量</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Enable / Disable menu icons / item badges.</span></span><br><span class="line"><span class="attr">menu_settings:</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">badges:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="头像设置"><a href="#头像设置" class="headerlink" title="头像设置"></a>头像设置</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Sidebar Avatar</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="comment"># Replace the default image and set the url here.</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">http://cdn.jackkke.top/blog/images/jackkke.jpg</span></span><br><span class="line">  <span class="comment"># If true, the avatar will be displayed in circle.</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If true, the avatar will be rotated with the cursor.</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="社交媒体配置"><a href="#社交媒体配置" class="headerlink" title="社交媒体配置"></a>社交媒体配置</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">GitHub:</span> <span class="string">https://github.com/jackkke</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-github</span></span><br><span class="line">  <span class="attr">E-Mail:</span> <span class="string">mailto:hangao1204@hotmail.com</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-envelope</span></span><br><span class="line">  <span class="attr">Weibo:</span> <span class="string">https://weibo.com/jackkke</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-weibo</span></span><br><span class="line"><span class="attr">social_icons:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">icons_only:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">transition:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="底部信息"><a href="#底部信息" class="headerlink" title="底部信息"></a>底部信息</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="comment"># Specify the year when the site was setup. If not defined, current year will be used.</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Icon between year and copyright info.</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">    <span class="comment"># Icon name in Font Awesome. See: https://fontawesome.com/icons</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">fa</span> <span class="string">fa-heart</span></span><br><span class="line">    <span class="comment"># If you want to animate the icon, set it to true.</span></span><br><span class="line">    <span class="attr">animated:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Change the color of icon, using Hex Code.</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;#ff0000&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># If not defined, `author` from Hexo `_config.yml` will be used.</span></span><br><span class="line">  <span class="attr">copyright:</span> <span class="string">Copyed</span> <span class="string">By</span> <span class="string">Jackkke</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Powered by Hexo &amp; NexT</span></span><br><span class="line">  <span class="attr">powered:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="字数总计配置"><a href="#字数总计配置" class="headerlink" title="字数总计配置"></a>字数总计配置</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="打赏，不必"><a href="#打赏，不必" class="headerlink" title="打赏，不必"></a>打赏，不必</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reward_settings:</span></span><br><span class="line">  <span class="comment"># If true, a donate button will be displayed in every article by default.</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">comment:</span> <span class="string">duck</span> <span class="string">不必！</span></span><br><span class="line"></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="attr">wechatpay:</span> <span class="string">http://cdn.jackkke.top/blog/images/wechatpay.jpg</span></span><br></pre></td></tr></table></figure>

<h3 id="相关文章（不准确，已关闭）"><a href="#相关文章（不准确，已关闭）" class="headerlink" title="相关文章（不准确，已关闭）"></a><del>相关文章（不准确，已关闭）</del></h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">related_posts:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">相关文章</span> <span class="comment"># Custom header, leave empty to use the default one</span></span><br><span class="line">  <span class="attr">display_in_home:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="文章在线编辑（已关闭）"><a href="#文章在线编辑（已关闭）" class="headerlink" title="文章在线编辑（已关闭）"></a><del>文章在线编辑（已关闭）</del></h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_edit:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://github.com/jackkke/blog/tree/main/source/</span></span><br></pre></td></tr></table></figure>

<h3 id="预加载-字体与js等"><a href="#预加载-字体与js等" class="headerlink" title="预加载 字体与js等"></a>预加载 字体与js等</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">preconnect:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="代码块格式，适配暗夜模式"><a href="#代码块格式，适配暗夜模式" class="headerlink" title="代码块格式，适配暗夜模式"></a>代码块格式，适配暗夜模式</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span><br><span class="line">  <span class="comment"># Code Highlight theme</span></span><br><span class="line">  <span class="comment"># All available themes: https://theme-next.js.org/highlight/</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">atom-one-light</span> <span class="comment"># default github stackoverflow-light</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">tomorrow-night-bright</span> <span class="comment"># atom-one-dark atom-one-dark-reasonable github-dark github-dark-dimmed stackoverflow-dark</span></span><br><span class="line">  <span class="attr">prism:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">prism</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">prism-dark</span></span><br><span class="line">  <span class="comment"># Add copy button on codeblock</span></span><br><span class="line">  <span class="attr">copy_button:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Available values: default | flat | mac</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">flat</span></span><br></pre></td></tr></table></figure>

<h3 id="返回顶部"><a href="#返回顶部" class="headerlink" title="返回顶部"></a>返回顶部</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Back to top in sidebar.</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Scroll percent label in b2t button.</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="文章阅读进度顶部进度条"><a href="#文章阅读进度顶部进度条" class="headerlink" title="文章阅读进度顶部进度条"></a>文章阅读进度顶部进度条</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Reading progress bar</span></span><br><span class="line"><span class="attr">reading_progress:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Available values: left | right</span></span><br><span class="line">  <span class="attr">start_at:</span> <span class="string">left</span></span><br><span class="line">  <span class="comment"># Available values: top | bottom</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span></span><br><span class="line">  <span class="attr">reversed:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#37c6c0&quot;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">3px</span></span><br></pre></td></tr></table></figure>

<h3 id="书签记录下次进入上次记录页面（已关闭）"><a href="#书签记录下次进入上次记录页面（已关闭）" class="headerlink" title="书签记录下次进入上次记录页面（已关闭）"></a><del>书签记录下次进入上次记录页面（已关闭）</del></h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">bookmark:</span></span><br><span class="line">  <span class="comment"># 与 github_banner 位置重叠，暂时不做放开</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Customize the color of the bookmark.</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#222&quot;</span></span><br><span class="line">  <span class="comment"># If auto, save the reading progress when closing the page or clicking the bookmark-icon.</span></span><br><span class="line">  <span class="comment"># If manual, only save it by clicking the bookmark-icon.</span></span><br><span class="line">  <span class="attr">save:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure>

<h3 id="右上角-Follow-图标"><a href="#右上角-Follow-图标" class="headerlink" title="右上角 Follow 图标"></a>右上角 Follow 图标</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">github_banner:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">permalink:</span> <span class="string">https://github.com/jackkke</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Follow</span> <span class="string">me</span> <span class="string">on</span> <span class="string">GitHub</span></span><br></pre></td></tr></table></figure>

<h3 id="自定义字体，强推-JetBrains-Mono"><a href="#自定义字体，强推-JetBrains-Mono" class="headerlink" title="自定义字体，强推 JetBrains Mono"></a>自定义字体，强推 <strong>JetBrains Mono</strong></h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">font:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">https://fonts.loli.net</span> <span class="comment"># https://fonts.font.im</span></span><br><span class="line">  <span class="attr">global:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">JetBrains</span> <span class="string">Mono</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line">  <span class="attr">title:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">JetBrains</span> <span class="string">Mono</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line">  <span class="attr">headings:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">JetBrains</span> <span class="string">Mono</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line">  <span class="attr">posts:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">JetBrains</span> <span class="string">Mono</span></span><br><span class="line">  <span class="attr">codes:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">JetBrains</span> <span class="string">Mono</span></span><br></pre></td></tr></table></figure>

<h3 id="副标题主页显示"><a href="#副标题主页显示" class="headerlink" title="副标题主页显示"></a>副标题主页显示</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">index_with_subtitle:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="页面部署压缩"><a href="#页面部署压缩" class="headerlink" title="页面部署压缩"></a><strong>页面部署压缩</strong></h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">pangu:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="评论系统"><a href="#评论系统" class="headerlink" title="评论系统"></a>评论系统</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">utterances:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">jackkke/blogUtterances</span> <span class="comment"># Github repository owner and name</span></span><br><span class="line">  <span class="comment"># Available values: pathname | url | title | og:title</span></span><br><span class="line">  <span class="attr">issue_term:</span> <span class="string">pathname</span></span><br><span class="line">  <span class="comment"># Available values: github-light | github-dark | preferred-color-scheme | github-dark-orange | icy-dark | dark-blue | photon-dark | boxy-light</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">preferred-color-scheme</span></span><br></pre></td></tr></table></figure>

<h3 id="页面访问统计"><a href="#页面访问统计" class="headerlink" title="页面访问统计"></a>页面访问统计</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">fa</span> <span class="string">fa-eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">far</span> <span class="string">fa-eye</span></span><br></pre></td></tr></table></figure>

<h3 id="本地搜索"><a href="#本地搜索" class="headerlink" title="本地搜索"></a>本地搜索</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If auto, trigger search by changing input.</span></span><br><span class="line">  <span class="comment"># If manual, trigger search by pressing enter key or search button.</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># Show top n results per article, show all results by setting to -1</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># Unescape html strings to the readable one.</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Preload the search data when the page loads.</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="国内加载js加速"><a href="#国内加载js加速" class="headerlink" title="国内加载js加速"></a>国内加载js加速</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">vendors:</span></span><br><span class="line">  <span class="comment"># The CDN provider of NexT internal scripts.</span></span><br><span class="line">  <span class="comment"># Available values: local | jsdelivr | unpkg | cdnjs | custom</span></span><br><span class="line">  <span class="comment"># Warning: If you are using the latest master branch of NexT, please set `internal: local`</span></span><br><span class="line">  <span class="attr">internal:</span> <span class="string">custom</span></span><br><span class="line">  <span class="comment"># The default CDN provider of third-party plugins.</span></span><br><span class="line">  <span class="comment"># Available values: local | jsdelivr | unpkg | cdnjs | custom</span></span><br><span class="line">  <span class="comment"># Dependencies for `plugins: local`: https://github.com/next-theme/plugins</span></span><br><span class="line">  <span class="attr">plugins:</span> <span class="string">custom</span></span><br><span class="line">  <span class="comment"># Custom CDN URL</span></span><br><span class="line">  <span class="comment"># For example:</span></span><br><span class="line">  <span class="comment"># custom_cdn_url: https://cdn.jsdelivr.net/npm/$&#123;npm_name&#125;@$&#123;version&#125;/$&#123;minified&#125;</span></span><br><span class="line">  <span class="comment"># custom_cdn_url: https://cdnjs.cloudflare.com/ajax/libs/$&#123;cdnjs_name&#125;/$&#123;version&#125;/$&#123;cdnjs_file&#125;</span></span><br><span class="line">  <span class="attr">custom_cdn_url:</span> <span class="string">https://cdn.bootcdn.net/ajax/libs/$&#123;cdnjs_name&#125;/$&#123;version&#125;/$&#123;cdnjs_file&#125;</span></span><br></pre></td></tr></table></figure>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-09-02/21358/">Hexo 6.x结合Next 8.x搭建（一）</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-09-02/21359/">Hexo 6.x结合Next 8.x搭建（二）</a></li></ul></div>
]]></content>
      <tags>
        <tag>hexo</tag>
        <tag>next</tag>
      </tags>
  </entry>
  <entry>
    <title>优化NexT 6.0版本</title>
    <url>/posts/2019-04-17/24134/</url>
    <content><![CDATA[<h2 id="优化NexT-6-0，本文完全按照个人喜欢设置"><a href="#优化NexT-6-0，本文完全按照个人喜欢设置" class="headerlink" title="优化NexT 6.0，本文完全按照个人喜欢设置"></a>优化NexT 6.0，本文完全按照个人喜欢设置</h2><p>本文主要参考：<a href="https://www.jianshu.com/p/3a05351a37dc">链接</a>，特别感谢</p>
<h2 id="Schemes主题选择"><a href="#Schemes主题选择" class="headerlink" title="Schemes主题选择"></a>Schemes主题选择</h2><p>以下配置均在NexT主题配置文件：<strong>themes&#x2F;next&#x2F;_config.yml</strong>中</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment"># scheme: Muse</span></span><br><span class="line"><span class="comment"># scheme: Mist</span></span><br><span class="line"><span class="comment"># scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br></pre></td></tr></table></figure>

<h2 id="取消文章不自动折叠"><a href="#取消文章不自动折叠" class="headerlink" title="取消文章不自动折叠"></a>取消文章不自动折叠</h2><p>首页文章不显示全部，折叠起来，防止文章过长影响阅读</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#此处改为true，意为自动折叠，length为折叠的长度</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure>
<p>或者采取另一种方案，在文章中间插入一句，即可实现随意折叠，且优先级高于上面的方案，可以两者共同使用</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">&lt;!--more--&gt;</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<p>当然你也可以在文章头加上，这样在文章列表只会显示你的描述</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">description: 文章描述</span><br></pre></td></tr></table></figure>

<h2 id="取消目录自动显示"><a href="#取消目录自动显示" class="headerlink" title="取消目录自动显示"></a>取消目录自动显示</h2><p>文章默认会展开右侧目录如果存在的话，我不太喜欢，隐藏掉</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">sidebar:</span></span><br><span class="line">  <span class="comment">#  - post    默认值，如果有目录自动展开，可隐藏</span></span><br><span class="line">  <span class="comment">#  - always  总是存在，不可隐藏</span></span><br><span class="line">  <span class="comment">#  - hide    默认隐藏，可以展开（采用这种）</span></span><br><span class="line">  <span class="comment">#  - remove  移除</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">hide</span></span><br></pre></td></tr></table></figure>

<h2 id="去掉文章目录标题的自动编号"><a href="#去掉文章目录标题的自动编号" class="headerlink" title="去掉文章目录标题的自动编号"></a>去掉文章目录标题的自动编号</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">false</span> <span class="comment"># 将此改为false即可</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span> <span class="comment"># 将此改为true每行目录超长自动换行</span></span><br><span class="line">  <span class="attr">expand_all:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">max_depth:</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>

<h2 id="设置网站缩略图标"><a href="#设置网站缩略图标" class="headerlink" title="设置网站缩略图标"></a>设置网站缩略图标</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">small:</span> <span class="string">/images/jackkke.jpg</span></span><br><span class="line">  <span class="attr">medium:</span> <span class="string">/images/jackkke.jpg</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/images/jackkke.jpg</span></span><br><span class="line">  <span class="comment"># safari_pinned_tab: /images/logo.svg</span></span><br><span class="line">  <span class="comment">#android_manifest: /images/manifest.json</span></span><br><span class="line">  <span class="comment">#ms_browserconfig: /images/browserconfig.xml</span></span><br></pre></td></tr></table></figure>

<h2 id="设置头像"><a href="#设置头像" class="headerlink" title="设置头像"></a>设置头像</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/images/jackkke.jpg</span> <span class="comment"># 需要把jackkke.jpg放到themes/next/source/images下</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h2 id="Github-follow-me-图标"><a href="#Github-follow-me-图标" class="headerlink" title="Github follow me 图标"></a>Github follow me 图标</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">github_banner:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 将此改为true，即可显示在右上角</span></span><br><span class="line">  <span class="attr">permalink:</span> <span class="string">https://github.com/jackkke</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Follow</span> <span class="string">me</span> <span class="string">on</span> <span class="string">GitHub</span></span><br></pre></td></tr></table></figure>

<h2 id="打赏功能"><a href="#打赏功能" class="headerlink" title="打赏功能"></a>打赏功能</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reward_settings:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 将此改成true，即可出现打赏按钮</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">comment:</span> <span class="string">坚持原创技术分享，您的支持将鼓励我继续创作！</span></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="attr">wechatpay:</span> <span class="string">/images/wechatpay.jpg</span> <span class="comment"># 此处去掉注释，并将你自己的收款码放到图片文件夹即可看到效果</span></span><br><span class="line">  <span class="comment"># alipay: /images/alipay.png</span></span><br><span class="line">  <span class="comment">#bitcoin: /images/bitcoin.png</span></span><br></pre></td></tr></table></figure>

<h2 id="丰富首页"><a href="#丰富首页" class="headerlink" title="丰富首页"></a>丰富首页</h2><h3 id="选择你需要的功能"><a href="#选择你需要的功能" class="headerlink" title="选择你需要的功能"></a>选择你需要的功能</h3><p>放开注释，该功能即可使用，键值对的值双竖线前面的代表功能名称，也就是访问路径，后面代表图标名称，默认即可</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span>                          <span class="string">//首页</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span>          <span class="string">//归档</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span>           <span class="string">//分类</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span>                     <span class="string">//标签</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span>                   <span class="string">//关于</span></span><br><span class="line">  <span class="comment"># schedule: /schedule/ || calendar        //日程表</span></span><br><span class="line">  <span class="comment"># sitemap: /sitemap.xml || sitemap        //站点地图</span></span><br><span class="line">  <span class="attr">commonweal:</span> <span class="string">/404/</span> <span class="string">||</span> <span class="string">heartbeat</span>          <span class="string">//公益404</span></span><br></pre></td></tr></table></figure>

<h3 id="分类功能"><a href="#分类功能" class="headerlink" title="分类功能"></a>分类功能</h3><blockquote>
<p>使用方法为在文章首title代码块处加上[categories: 分类名]即可</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># 控制台执行该命令（下同）</span><br><span class="line">hexo new page categories</span><br><span class="line">生成的页面中加上</span><br><span class="line">type: &quot;categories&quot;</span><br></pre></td></tr></table></figure>

<h3 id="标签功能、"><a href="#标签功能、" class="headerlink" title="标签功能、"></a>标签功能、</h3><blockquote>
<p>使用方法为在文章首title代码块处加上[tags: 标签名]即可</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 多tags也可以，方法为：</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">标签1</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">标签2</span></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line"><span class="attr">tags:</span> [<span class="string">标签1</span>, <span class="string">标签2</span>]</span><br></pre></td></tr></table></figure>

<h3 id="关于页面"><a href="#关于页面" class="headerlink" title="关于页面"></a>关于页面</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">hexo new page about</span><br></pre></td></tr></table></figure>

<h3 id="本地搜索"><a href="#本地搜索" class="headerlink" title="本地搜索"></a>本地搜索</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">先执行，下面这行代码，增加依赖</span></span><br><span class="line">npm install hexo-generator-search  --save</span><br><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#修改HEXO配置文件，增加以下内容</span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#然后修改NEXT配置文件</span></span><br><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 此处改为true，增加本地搜索功能</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="404页面"><a href="#404页面" class="headerlink" title="404页面"></a>404页面</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new page 404</span><br></pre></td></tr></table></figure>
<p>在自动生成的页面后追加以下内容</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>早点回家<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js&quot;</span> <span class="attr">homePageName</span>=<span class="string">&quot;返回首页&quot;</span> <span class="attr">homePageUrl</span>=<span class="string">&quot;https://jackkke.github.io&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="草稿"><a href="#草稿" class="headerlink" title="草稿"></a>草稿</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行下面命令，生成名为“草稿.md”的草稿在/source/_drafts文件夹下</span></span><br><span class="line">hexo new draft &quot;草稿&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行下面命令，直接把草稿“草稿.md”发布，也可以手动把_drafts文件夹下的*.md文件移到_posts下</span></span><br><span class="line">hexo publish &quot;草稿&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如果想在测试环境查看草稿，可以修改hexo配置文件</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者使用以下启动命令来启动项目</span></span><br><span class="line">hexo server --drafts</span><br></pre></td></tr></table></figure>

<h2 id="增加评论功能"><a href="#增加评论功能" class="headerlink" title="增加评论功能"></a>增加评论功能</h2><h3 id="LiveRe我首先采用的是LiveRe，参考链接：点我达，但这个评论系统初始化超级慢，被弃用"><a href="#LiveRe我首先采用的是LiveRe，参考链接：点我达，但这个评论系统初始化超级慢，被弃用" class="headerlink" title="LiveRe我首先采用的是LiveRe，参考链接：点我达，但这个评论系统初始化超级慢，被弃用"></a>LiveRe我首先采用的是LiveRe，参考链接：<a href="https://blog.csdn.net/weixin_41196185/article/details/79178780">点我达</a>，但这个评论系统初始化超级慢，被弃用</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># LiveRe comments system</span></span><br><span class="line"><span class="comment"># You can get your uid from https://livere.com/insight/myCode (General web site)</span></span><br><span class="line"><span class="attr">livere_uid:</span> <span class="string">注册成功登陆后找到data-uid，将其填到这个地方即可</span></span><br></pre></td></tr></table></figure>

<h3 id="gitment"><a href="#gitment" class="headerlink" title="gitment"></a>gitment</h3><p>然后又发现了gitment，但他的问题比较多，比如issue名长度限制、第一次初始化也有很大问题，弄到一半弃用</p>
<h3 id="gitalk"><a href="#gitalk" class="headerlink" title="gitalk"></a>gitalk</h3><p>最终采取的方案是gitalk，issue名限制问题也不存在。gitalk和gitment采取的解决方案相同，都是issue，这两个方案目前NexT都已经直接支持，需要先去注册一下OAuth<a href="https://github.com/settings/applications/new">点我达</a>，记下Client ID和Client Secret。</p>
<blockquote>
<p>注意Authorization callback URL填自己的网站url： <a href="https://jackkke.github.io/">https://jackkke.github.io/</a></p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">gitalk:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 这个地方改为true</span></span><br><span class="line">  <span class="attr">github_id:</span> <span class="string">你的github名</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">专门存储评论系统的资源库，或者本项目资源库亦可</span></span><br><span class="line">  <span class="attr">client_id:</span> <span class="string">你的oauth</span> <span class="string">ID</span></span><br><span class="line">  <span class="attr">client_secret:</span> <span class="string">你的oauth</span> <span class="string">密码</span></span><br><span class="line">  <span class="attr">admin_user:</span> <span class="string">管理员的github</span> <span class="string">name，可以是多个[&#x27;name1&#x27;,</span> <span class="string">&#x27;name2&#x27;</span><span class="string">],必须要设置，需要管理员来初始化评论</span></span><br><span class="line">  <span class="attr">distraction_free_mode:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">language:</span></span><br></pre></td></tr></table></figure>

<h2 id="添加站点与文章访问计数"><a href="#添加站点与文章访问计数" class="headerlink" title="添加站点与文章访问计数"></a>添加站点与文章访问计数</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 将此改为true，开放计数功能</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">eye</span></span><br></pre></td></tr></table></figure>

<p>底部计数只有图标，没有文字，打开themes&#x2F;next&#x2F;layout&#x2F;_third-party&#x2F;analytics&#x2F;busuanzi-counter.swig</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-&#123;&#123; theme.busuanzi_count.total_visitors_icon &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># 增加 &#123;&#123; __(&#x27;footer.total_visitors&#x27;) &#125;&#125;更改为</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-&#123;&#123; theme.busuanzi_count.total_visitors_icon &#125;&#125;&quot;</span>&gt;</span> &#123;&#123; __(&#x27;footer.total_visitors&#x27;) &#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-&#123;&#123; theme.busuanzi_count.total_views_icon &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># 增加 &#123;&#123; __(&#x27;footer.total_views&#x27;) &#125;&#125;更改为</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-&#123;&#123; theme.busuanzi_count.total_views_icon &#125;&#125;&quot;</span>&gt;</span> &#123;&#123; __(&#x27;footer.total_views&#x27;) &#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="隐藏版本信息"><a href="#隐藏版本信息" class="headerlink" title="隐藏版本信息"></a>隐藏版本信息</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">powered:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment"># 此处改为false，隐藏hexo信息  version: false # 只将此处改为false，只隐藏版本信息theme:  enable: false # 此处改为false，隐藏next scheme信息  version: false # 只将此处改为false，只隐藏版本信息</span></span><br></pre></td></tr></table></figure>
<h2 id="post-edit"><a href="#post-edit" class="headerlink" title="post_edit"></a>post_edit</h2><div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-17/26406/">Hexo + GitHub Pages搭建博客</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-17/24134/">优化NexT 6.0版本</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-23/33295/">Hexo 部署到github或gitee</a></li></ul></div>]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>工具</tag>
        <tag>开端</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo + GitHub Pages搭建博客</title>
    <url>/posts/2019-04-17/26406/</url>
    <content><![CDATA[<h1 id="Hexo-GitHub-Pages搭建博客"><a href="#Hexo-GitHub-Pages搭建博客" class="headerlink" title="Hexo + GitHub Pages搭建博客"></a>Hexo + GitHub Pages搭建博客</h1><h2 id="基本要求"><a href="#基本要求" class="headerlink" title="基本要求"></a>基本要求</h2><ul>
<li>注册GitHub账号，由于网络抽风，时不时会特别慢，推荐搭配梯子来注册（后续写篇文章）。</li>
<li>电脑需要node环境，不懂node的可能额外需要一点时间（后续写篇文章）。</li>
<li>编辑工具，推荐VSCode，搭配Markdown Preview Enhanced插件，可以实时预览。</li>
</ul>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>注册GitHub账号，步骤省略，然后在上面新建一个资源库，这时需要注意的是资源库的名称一定为”username.github.io”，这样你的博客搭建好后，才可直接username.github.io来访问，例如<a href="https://jackkke.github.io/">我的博客</a></p>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-17/26406/">Hexo + GitHub Pages搭建博客</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-17/24134/">优化NexT 6.0版本</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2019-04-23/33295/">Hexo 部署到github或gitee</a></li></ul></div>]]></content>
      <tags>
        <tag>开端</tag>
      </tags>
  </entry>
  <entry>
    <title>BigDecimal常用方法</title>
    <url>/posts/2019-05-07/29247/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>Chrome浏览器showModalDialog兼容性及解决方案</title>
    <url>/posts/2017-01-04/59158/</url>
    <content><![CDATA[<h1 id="源链接"><a href="#源链接" class="headerlink" title="源链接"></a><a href="https://www.cnblogs.com/hangao/p/6248692.html">源链接</a></h1><blockquote class="blockquote-center">
<p>chrome对showModalDialog方法是不兼容的，现在有年代久远的项目，是用的window.showModalDialog方式打开模态窗口，但现在提出有兼容性问题。</p>

</blockquote>



<h1 id="对此，我的解决方案是通过window-open的方式来解决。"><a href="#对此，我的解决方案是通过window-open的方式来解决。" class="headerlink" title="对此，我的解决方案是通过window.open的方式来解决。"></a>对此，我的解决方案是通过window.open的方式来解决。</h1><h2 id="showModalDialog方法的执行是阻塞的，而open不是。"><a href="#showModalDialog方法的执行是阻塞的，而open不是。" class="headerlink" title="showModalDialog方法的执行是阻塞的，而open不是。"></a>showModalDialog方法的执行是阻塞的，而open不是。</h2><p>showModalDialog好比是同步的，而open是异步，想要解决此问题，可以在子窗口中调用父窗口的方法把返回值传回去。</p>
<h2 id="showModalDialog方法打开的窗口是模态，而open不是。"><a href="#showModalDialog方法打开的窗口是模态，而open不是。" class="headerlink" title="showModalDialog方法打开的窗口是模态，而open不是。"></a>showModalDialog方法打开的窗口是模态，而open不是。</h2><span id="more"></span>
<p>没有找到此问题的完美解决方案，我所想的是在父窗口定义一个常量hasOpenWindow，打开窗口时将其改为true，当期为true时，将焦点定位在刚才打开的窗口而不去新建，在父窗口的回掉函数中再将此常量改为false。</p>
<h2 id="以下是chromeWindowShowModalDialog-js"><a href="#以下是chromeWindowShowModalDialog-js" class="headerlink" title="以下是chromeWindowShowModalDialog.js"></a>以下是chromeWindowShowModalDialog.js</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 打开方式对比：</span></span><br><span class="line"><span class="comment"> *     window.open(&quot;Sample.htm&quot;,null,&quot;height=200,width=400,status=yes,toolbar=no,menubar=no&quot;);</span></span><br><span class="line"><span class="comment"> *     window.showModalDialog(&quot;modal.htm&quot;,obj,&quot;dialogWidth=200px;dialogHeight=100px&quot;);</span></span><br><span class="line"><span class="comment"> *     因window.showmodaldialog 与 window.open 参数不一样，所以封装的时候用正则去格式化一下参数</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 定义一个全局变量&lt;has_showModalDialog&gt;判定是否有原生showModalDialog方法</span></span><br><span class="line"><span class="comment"> * 如果它不存在,自定义window.showModalDialog</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * if (window.opener != undefined &amp;&amp; window.opener._doChromeWindowShowModalDialog) &#123;</span></span><br><span class="line"><span class="comment"> *         window.opener.__doChromeWindowShowModalDialog(tmplInfo);//for chrome</span></span><br><span class="line"><span class="comment"> *     &#125;else&#123;</span></span><br><span class="line"><span class="comment"> *         window.returnValue = tmplInfo;</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> has_showModalDialog = !!<span class="variable language_">window</span>.<span class="property">showModalDialog</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">showModalDialog</span> == <span class="literal">undefined</span>)&#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">showModalDialog</span> = <span class="keyword">function</span>(<span class="params">url,mixedVar,features</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">hasOpenWindow</span>)&#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="property">myNewWindow</span>.<span class="title function_">focus</span>();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">hasOpenWindow</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(mixedVar) <span class="keyword">var</span> mixedVar = mixedVar;</span><br><span class="line">    <span class="keyword">if</span>(features) <span class="keyword">var</span> features = features.<span class="title function_">replace</span>(<span class="regexp">/(dialog)|(px)/ig</span>,<span class="string">&quot;&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/;/g</span>,<span class="string">&#x27;,&#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/\:/g</span>,<span class="string">&quot;=&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> left = (<span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">width</span> - <span class="built_in">parseInt</span>(features.<span class="title function_">match</span>(<span class="regexp">/width[\s]*=[\s]*([\d]+)/i</span>)[<span class="number">1</span>]))/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">var</span> top = (<span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">height</span> - <span class="built_in">parseInt</span>(features.<span class="title function_">match</span>(<span class="regexp">/height[\s]*=[\s]*([\d]+)/i</span>)[<span class="number">1</span>]))/<span class="number">2</span>;</span><br><span class="line">    url = url + <span class="string">&quot;&amp;temp=&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">myNewWindow</span> = <span class="variable language_">window</span>.<span class="title function_">open</span>(url,<span class="string">&quot;_blank&quot;</span>,features);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">_doChromeWindowShowModalDialog</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">hasOpenWindow</span> = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="title function_">doChromeWindowShowModalDialog</span>(obj);</span><br><span class="line">  &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="子窗口点击确定或者关闭时："><a href="#子窗口点击确定或者关闭时：" class="headerlink" title="子窗口点击确定或者关闭时："></a>子窗口点击确定或者关闭时：</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">opener</span> != <span class="literal">undefined</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">opener</span>.<span class="property">_doChromeWindowShowModalDialog</span>) &#123;</span><br><span class="line">　　<span class="comment">//for chrome</span></span><br><span class="line">　　<span class="variable language_">window</span>.<span class="property">opener</span>.<span class="title function_">_doChromeWindowShowModalDialog</span>(tmplInfo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="父窗口的回调函数"><a href="#父窗口的回调函数" class="headerlink" title="父窗口的回调函数"></a>父窗口的回调函数</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doChromeWindowShowModalDialog</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj!=<span class="literal">null</span>)&#123;</span><br><span class="line">    　　<span class="comment">//TODO</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript循环</title>
    <url>/posts/2019-04-29/58383/</url>
    <content><![CDATA[<h2 id="JavaScript-数组循环"><a href="#JavaScript-数组循环" class="headerlink" title="JavaScript 数组循环"></a>JavaScript 数组循环</h2><h3 id="一般的for循环"><a href="#一般的for循环" class="headerlink" title="一般的for循环"></a>一般的for循环</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> array = [<span class="string">&quot;第一个&quot;</span>, <span class="string">&quot;第二个&quot;</span>, <span class="string">&quot;第三个&quot;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; array.<span class="property">length</span>; index++) &#123;</span><br><span class="line">    <span class="keyword">const</span> element = array[index];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;For Loop&quot;</span> + element)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<blockquote>
<p>For Loop第一个<br>For Loop第二个<br>For Loop第三个</p>
</blockquote>
<h3 id="for…in-遍历"><a href="#for…in-遍历" class="headerlink" title="for…in 遍历"></a>for…in 遍历</h3><span id="more"></span>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> array = [<span class="string">&quot;第一个&quot;</span>, <span class="string">&quot;第二个&quot;</span>, <span class="string">&quot;第三个&quot;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> array) &#123;</span><br><span class="line">    <span class="comment">// key 为索引</span></span><br><span class="line">    <span class="keyword">const</span> element = array[key];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;For-In Loop&quot;</span> + element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<blockquote>
<p>For-In Loop第一个<br>For-In Loop第二个<br>For-In Loop第三个</p>
</blockquote>
<h3 id="for…of-遍历"><a href="#for…of-遍历" class="headerlink" title="for…of 遍历"></a>for…of 遍历</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> array = [<span class="string">&quot;第一个&quot;</span>, <span class="string">&quot;第二个&quot;</span>, <span class="string">&quot;第三个&quot;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> iterator <span class="keyword">of</span> array) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;For-of Loop&quot;</span> + iterator)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<blockquote>
<p>For-of Loop第一个<br>For-of Loop第二个<br>For-of Loop第三个</p>
</blockquote>
<h3 id="forEach-遍历"><a href="#forEach-遍历" class="headerlink" title="forEach 遍历"></a>forEach 遍历</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> array = [<span class="string">&quot;第一个&quot;</span>, <span class="string">&quot;第二个&quot;</span>, <span class="string">&quot;第三个&quot;</span>];</span><br><span class="line">array.<span class="title function_">forEach</span>(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ForEach Loop&quot;</span> + element)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<blockquote>
<p>ForEach Loop第一个<br>ForEach Loop第二个<br>ForEach Loop第三个</p>
</blockquote>
<h2 id="JavaScript-对象属性循环"><a href="#JavaScript-对象属性循环" class="headerlink" title="JavaScript 对象属性循环"></a>JavaScript 对象属性循环</h2><h3 id="for…in-遍历-1"><a href="#for…in-遍历-1" class="headerlink" title="for…in 遍历"></a>for…in 遍历</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">obj.<span class="property">id</span> = <span class="string">&quot;id&quot;</span>;</span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&quot;name&quot;</span>;</span><br><span class="line">obj.<span class="property">code</span> = <span class="string">&quot;code&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">        <span class="keyword">const</span> element = obj[key];</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;key: &quot;</span> + key + <span class="string">&quot;, value: &quot;</span> + element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<blockquote>
<p>key: id, value: id<br>key: name, value: name<br>key: code, value: code</p>
</blockquote>
<h3 id="通过Object-keys生成数组"><a href="#通过Object-keys生成数组" class="headerlink" title="通过Object.keys生成数组"></a>通过Object.keys生成数组</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>();</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<blockquote>
<p>[“id”, “name”, “code”]</p>
</blockquote>
<p>现在有了对象的所有key，亦可通过上面的数组循环的方式来循环获取对象属性</p>
]]></content>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>MAC 虚拟机</title>
    <url>/posts/2019-09-06/56450/</url>
    <content><![CDATA[<h1 id="MAC-虚拟机windows备用系统最佳选择-Windows-Thin"><a href="#MAC-虚拟机windows备用系统最佳选择-Windows-Thin" class="headerlink" title="MAC 虚拟机windows备用系统最佳选择 Windows Thin"></a>MAC 虚拟机windows备用系统最佳选择 Windows Thin</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>下载地址：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">ed2k://|file|en_windows_thin_pc_x86_697681.iso|1576980480|2D0E6A048EB3F314F556B4F0834A95E2|/</span><br><span class="line">来源：http://msdn.itellyou.cn/</span><br></pre></td></tr></table></figure>

<h2 id="汉化"><a href="#汉化" class="headerlink" title="汉化"></a>汉化</h2><p>下载地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://download.microsoft.com/download/8/6/1/8616D57C-1163-45FB-832A-15FA60571002/SP1/Chinese (Simplified) Language Pack - Windows Embedded Standard 7 SP1/lp.cab</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<p>汉化步骤</p>
<ul>
<li>下载Windows Thin PC 简体中文语言包lp.cab放到C盘的根目录</li>
<li>以管理员身份运行CMD命令输入：dism &#x2F;online &#x2F;add-package &#x2F;packagepath:C:\lp.cab</li>
<li>完成后输入：bcdedit &#x2F;set {current} locale zh-cn</li>
<li>完成后再输入：bcdboot %WinDir% &#x2F;l zh-cn</li>
<li>完成后重启计算机进入控制面板进行设置即可。</li>
</ul>
<h2 id="假激活"><a href="#假激活" class="headerlink" title="假激活"></a>假激活</h2><p>首先，进入控制面板，找到管理工具，随后进入系统服务控制台，找到软件保护服务-Software Protection，禁用并停止此服务。下一步，进入 <code>C:\Windows\System32</code> 系统目录，找到 <code>slui.exe</code> 这个可执行文件。它负责记录和变更系统的激活状态。我们要做的事情就是把这个文件干掉，对该文件获取权限进行删除，也可以选择下载火绒来强制删除。</p>
]]></content>
      <tags>
        <tag>mac</tag>
      </tags>
  </entry>
  <entry>
    <title>homebrew</title>
    <url>/posts/2019-11-11/59400/</url>
    <content><![CDATA[<h1 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a>Homebrew</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span><br></pre></td></tr></table></figure>

<h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/uninstall)&quot;</span><br></pre></td></tr></table></figure>
<span id="more"></span>



<p>y</p>
<p>brew help</p>
<p>brew list</p>
<p>brew cask list</p>
<p>brew cask install cakebrew</p>
<p>然后把homebrew-core的镜像地址也设为中科院的国内镜像</p>
<p>cd “$(brew –repo)”</p>
<p>git remote set-url origin <a href="https://mirrors.ustc.edu.cn/brew.git">https://mirrors.ustc.edu.cn/brew.git</a></p>
<p>cd “$(brew –repo)&#x2F;Library&#x2F;Taps&#x2F;homebrew&#x2F;homebrew-core”</p>
<p>git remote set-url origin <a href="https://mirrors.ustc.edu.cn/homebrew-core.git">https://mirrors.ustc.edu.cn/homebrew-core.git</a></p>
<p>执行更新，成功：</p>
<p>brew update</p>
<p>最后用这个命令检查无错误：</p>
<p>brew doctor</p>
<p>这样海外和已经有系统全局代理设置的朋友们就可以直接使用 brew 命令安装软件了。</p>
<p>接着换源：<br>直接使用 Homebrew 还需要更改默认源，不然谁用谁想打人，原因你懂的。以下是将默认源替换为国内 USTC 源的方法。</p>
<p>替换核心软件仓库</p>
<p>cd “$(brew –repo)&#x2F;Library&#x2F;Taps&#x2F;homebrew&#x2F;homebrew-core”<br>git remote set-url origin <a href="https://mirrors.ustc.edu.cn/homebrew-core.git">https://mirrors.ustc.edu.cn/homebrew-core.git</a></p>
<p>替换 cask 软件仓库（提供 macOS 应用和大型二进制文件）</p>
<p>cd “$(brew –repo)”&#x2F;Library&#x2F;Taps&#x2F;caskroom&#x2F;homebrew-cask<br>git remote set-url origin <a href="https://mirrors.ustc.edu.cn/homebrew-cask.git">https://mirrors.ustc.edu.cn/homebrew-cask.git</a></p>
<p>替换 Bottles 源（Homebrew 预编译二进制软件包）</p>
<p>bash（默认 shell）用户：</p>
<p>echo ‘export HOMEBREW_BOTTLE_DOMAIN&#x3D;<a href="https://mirrors.ustc.edu.cn/homebrew-bottles">https://mirrors.ustc.edu.cn/homebrew-bottles</a>‘ &gt;&gt; ~&#x2F;.bash_profile<br>source ~&#x2F;.bash_profile</p>
<p>zsh 用户：</p>
<p>echo ‘export HOMEBREW_BOTTLE_DOMAIN&#x3D;<a href="https://mirrors.ustc.edu.cn/homebrew-bottles">https://mirrors.ustc.edu.cn/homebrew-bottles</a>‘ &gt;&gt; ~&#x2F;.zshrc<br>source ~&#x2F;.zshrc</p>
]]></content>
      <tags>
        <tag>brew</tag>
      </tags>
  </entry>
  <entry>
    <title>mac开启任何来源</title>
    <url>/posts/2019-09-06/44229/</url>
    <content><![CDATA[<h1 id="mac开启任何来源"><a href="#mac开启任何来源" class="headerlink" title="mac开启任何来源"></a>mac开启任何来源</h1><p>Mac在macOS Sierra系统下，系统偏好设置中的“安全与隐私”默认已经去除了允许“任何来源”App的选项，如果不开启会直接影响到无法运行一些第三方应用。</p>
<h2 id="sudo-spctl-–master-disable"><a href="#sudo-spctl-–master-disable" class="headerlink" title="sudo spctl –master-disable"></a>sudo spctl –master-disable</h2>]]></content>
      <tags>
        <tag>mac</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL5.7等免安装版配置方法</title>
    <url>/posts/2016-04-18/16640/</url>
    <content><![CDATA[<h1 id="源链接"><a href="#源链接" class="headerlink" title="源链接"></a><a href="https://www.cnblogs.com/hangao/p/5403641.html">源链接</a></h1><h1 id="MySQL-5-6-37等免安装版配置方法"><a href="#MySQL-5-6-37等免安装版配置方法" class="headerlink" title="MySQL-5.6.37等免安装版配置方法"></a>MySQL-5.6.37等免安装版配置方法</h1><h2 id="下载MySQL-5-6-37-（直接百度搜索mysql下载即可）"><a href="#下载MySQL-5-6-37-（直接百度搜索mysql下载即可）" class="headerlink" title="下载MySQL-5.6.37       （直接百度搜索mysql下载即可）"></a>下载MySQL-5.6.37       （直接百度搜索mysql下载即可）</h2><h2 id="解压MySQL压缩包"><a href="#解压MySQL压缩包" class="headerlink" title="解压MySQL压缩包"></a>解压MySQL压缩包</h2><p>将以下载的MySQL压缩包解压到自定义目录下,我的解压目录是:<br>“C:\Java\mysql”<br>将解压目录下默认文件 my-default.ini 拷贝一份，改名 my.ini<br>复制下面的配置信息到 my.ini 保存<br>#mysql5.7没有my-default.ini,可自己新建my.ini将下面的配置复制进去</p>
<span id="more"></span>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment">#绑定IPv4和3306端口</span></span><br><span class="line"><span class="attr">bind-address</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">port</span> = <span class="number">3306</span></span><br><span class="line"><span class="comment"># 设置mysql的安装目录,即你解压缩安装包的位置，需要注意到的是这里是斜杠&quot;/&quot; 而不是Windows里面的反斜杠&#x27;\&quot;</span></span><br><span class="line"><span class="attr">basedir</span>=C:/Java/mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置mysql数据库的数据的存放目录</span></span><br><span class="line"><span class="attr">datadir</span>=C:/Java/mysql/data</span><br><span class="line"><span class="comment"># 允许最大连接数</span></span><br><span class="line"><span class="attr">max_connections</span>=<span class="number">200</span></span><br><span class="line"><span class="comment">#设置字符集为utf8</span></span><br><span class="line"><span class="attr">loose-default-character-set</span> = utf8</span><br><span class="line"></span><br><span class="line"><span class="comment">#之前此处未加，导致数据库的默认编码为latin1</span></span><br><span class="line"></span><br><span class="line"><span class="attr">character-set-server</span> = utf8</span><br><span class="line"></span><br><span class="line"><span class="comment">#开启查询缓存</span></span><br><span class="line"><span class="attr">explicit_defaults_for_timestamp</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">sql_mode</span>=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br><span class="line"></span><br><span class="line"><span class="section">[WinMySQLadmin]</span></span><br><span class="line"><span class="attr">Server</span> = C:/Java/mysql/bin/mysqld.exe</span><br></pre></td></tr></table></figure>

<h2 id="添加环境变量"><a href="#添加环境变量" class="headerlink" title="添加环境变量"></a>添加环境变量</h2><p>1）变量名：MYSQL_HOME 变量值：c:\Java\mysql<br>2）Path中添加 %MYSQL_HOME%\bin 添加的时候注意分隔符“;”</p>
<h2 id="将mysql注册为windows系统服务-以管理员身份-运行-命令提示符"><a href="#将mysql注册为windows系统服务-以管理员身份-运行-命令提示符" class="headerlink" title="将mysql注册为windows系统服务 (以管理员身份 运行 命令提示符)"></a>将mysql注册为windows系统服务 (以管理员身份 运行 命令提示符)</h2><p>1）从控制台进入到MySQL解压目录下的 bin 目录下：<br>2）输入服务安装命令：mysqld -install<br>3）5.6版本到此就安装完成，5.7版本不带data文件夹，需继续执行以下命令，初始化data文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysqld --initialize-insecure --user=mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">移除服务命令为：mysqld remove</span></span><br></pre></td></tr></table></figure>

<h2 id="修改-root-账号的密码"><a href="#修改-root-账号的密码" class="headerlink" title="修改 root 账号的密码"></a>修改 root 账号的密码</h2><p>刚安装完成时root账号默认密码为空，此时可以将密码修改为指定的密码。<br>C:\Java\mysql\bin&gt;mysql -uroot -p root<br>Enter password: （空）</p>
<p>mysqladmin: [Warning] Using a password on the command line interface can be insecure.<br>Warning: Since password will be sent to server in plain text, use ssl connection to ensure password safety.</p>
<h2 id="启动关闭MySQL服务-以管理员身份-运行-命令提示符"><a href="#启动关闭MySQL服务-以管理员身份-运行-命令提示符" class="headerlink" title="启动关闭MySQL服务 (以管理员身份 运行 命令提示符)"></a>启动关闭MySQL服务 (以管理员身份 运行 命令提示符)</h2><p>方法一：</p>
<p>启动服务命令为：net start mysql</p>
<p>关闭服务命令为：net stop mysql</p>
<p>方法二：<br>打开管理工具 服务，找到MySQL服务。<br>通过右键选择启动或者直接点击左边的启动来启动服务。</p>
<h2 id="MySQL控制台快捷方式建立"><a href="#MySQL控制台快捷方式建立" class="headerlink" title="MySQL控制台快捷方式建立:"></a>MySQL控制台快捷方式建立:</h2><p>   1）桌面右键-&gt;新建-&gt;快捷方式-&gt;对象位置输入：C:\Windows\System32\cmd.exe 确定，快捷方式建立成功<br>   2）右键单击刚才建立的快捷方式-&gt;属性-&gt;把目标一栏修改成MySQL启动参数：<br>   C:\Windows\System32\cmd.exe “C:\mysql\bin” &#x2F;k mysql -uroot -proot<br>   3）修改完成后点击确定保存，直接双击快捷方式即可连接到MySQL数据库</p>
<h2 id="补充："><a href="#补充：" class="headerlink" title="补充："></a>补充：</h2><p>my.ini 中加上 lower_case_table_names &#x3D; 0 #可以区分大小写，windows可以加上跟linux统一</p>
]]></content>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>Mysql常用函数</title>
    <url>/posts/2019-05-09/38183/</url>
    <content><![CDATA[<h2 id="SQL-Aggregate-函数"><a href="#SQL-Aggregate-函数" class="headerlink" title="SQL Aggregate 函数"></a>SQL Aggregate 函数</h2><ul>
<li>AVG() - 返回平均值</li>
<li>COUNT() - 返回行数</li>
<li>FIRST() - 返回第一个记录的值</li>
<li>LAST() - 返回最后一个记录的值</li>
<li>MAX() - 返回最大值</li>
<li>MIN() - 返回最小值</li>
<li>SUM() - 返回总和<span id="more"></span></li>
</ul>
<h2 id="SQL-Scalar-函数"><a href="#SQL-Scalar-函数" class="headerlink" title="SQL Scalar 函数"></a>SQL Scalar 函数</h2><h3 id="UCASE-将某个字段转换为大写"><a href="#UCASE-将某个字段转换为大写" class="headerlink" title="UCASE() - 将某个字段转换为大写"></a>UCASE() - 将某个字段转换为大写</h3><ul>
<li>LCASE() - 将某个字段转换为小写</li>
<li>MID() - 从某个文本字段提取字符，MySql 中使用</li>
<li>SubString(字段，1，end) - 从某个文本字段提取字符</li>
</ul>
<h3 id="LEN-返回某个文本字段的长度"><a href="#LEN-返回某个文本字段的长度" class="headerlink" title="LEN() - 返回某个文本字段的长度"></a>LEN() - 返回某个文本字段的长度</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LEN(<span class="string">&#x27;test_len&#x27;</span>) <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure>

<h3 id="ROUND-对某个数值字段进行指定小数位数的四舍五入"><a href="#ROUND-对某个数值字段进行指定小数位数的四舍五入" class="headerlink" title="ROUND() - 对某个数值字段进行指定小数位数的四舍五入"></a>ROUND() - 对某个数值字段进行指定小数位数的四舍五入</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> ROUND(<span class="number">1.49</span>);</span><br><span class="line"><span class="keyword">select</span> ROUND(<span class="number">1.55</span>);</span><br></pre></td></tr></table></figure>

<p>输入结果:</p>
<blockquote>
<p>1<br>2</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> ROUND(<span class="number">1.49</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">select</span> ROUND(<span class="number">1.49</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">select</span> ROUND(<span class="number">1.55</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">select</span> ROUND(<span class="number">1.55</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>输入结果:</p>
<blockquote>
<p>1<br>1.5<br>2<br>1.6</p>
</blockquote>
<h3 id="NOW-返回当前的系统日期和时间"><a href="#NOW-返回当前的系统日期和时间" class="headerlink" title="NOW() - 返回当前的系统日期和时间"></a>NOW() - 返回当前的系统日期和时间</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NOW() <span class="keyword">FROM</span> <span class="keyword">TABLE</span>;</span><br></pre></td></tr></table></figure>

<p>输入结果:</p>
<blockquote>
<p>2019-05-09 15:37:13</p>
</blockquote>
<h3 id="FORMAT-格式化某个字段的显示方式"><a href="#FORMAT-格式化某个字段的显示方式" class="headerlink" title="FORMAT() - 格式化某个字段的显示方式"></a>FORMAT() - 格式化某个字段的显示方式</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> FORMAT(<span class="number">1000000</span>,<span class="number">2</span>) <span class="keyword">FROM</span> <span class="keyword">TABLE</span>;</span><br><span class="line"><span class="keyword">SELECT</span> FORMAT(<span class="number">1000000.11111</span>,<span class="number">2</span>) <span class="keyword">FROM</span> <span class="keyword">TABLE</span>;</span><br><span class="line"><span class="keyword">select</span> format(<span class="number">1000000.11111</span>,<span class="number">0</span>) <span class="keyword">FROM</span> <span class="keyword">TABLE</span>;</span><br><span class="line"><span class="keyword">SELECT</span> FORMAT(<span class="number">100000.55555</span>,<span class="number">2</span>) <span class="keyword">FROM</span> <span class="keyword">TABLE</span>;</span><br><span class="line"><span class="keyword">SELECT</span> FORMAT(<span class="number">100000.55555</span>,<span class="number">0</span>) <span class="keyword">FROM</span> <span class="keyword">TABLE</span>;</span><br></pre></td></tr></table></figure>

<p>输入结果，格式为###,###,###.###，并且保留小数方式为四舍五入</p>
<blockquote>
<p>10,000.00<br>1,000,000.11<br>1,000,000<br>100,000.56<br>100,001</p>
</blockquote>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
  </entry>
  <entry>
    <title>如何让plsql查询的数据可编辑及两种方法的比较</title>
    <url>/posts/2016-04-14/8067/</url>
    <content><![CDATA[<h1 id="源链接"><a href="#源链接" class="headerlink" title="源链接"></a><a href="https://www.cnblogs.com/hangao/p/5390099.html">源链接</a></h1><p>我们执行一个查询sql，比如select * from Table t;的时候，</p>
<p>想要去编辑他的结果，点击工具栏上那个小锁，会有提示：“这些查询结果不可更新，请包括ROWID……….”</p>
<p>然后我们来看plsql自带的一些功能</p>
<p>在某个表名上右击点击“查询数据”出现的sql语句是：select * from Table t;</p>
<p>在某个表名上右击点击“修改数据”出现的sql语句是：select t.*, t.rowid from Table t;</p>
<h1 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h1><p>比如我们查询这样一条sql：select A,B from AB</p>
<span id="more"></span>
<p>如果想让他编辑的话可以改为以下sql：select t.A,t.B,t.rowid from AB t</p>
<p>查询后 点击查询结果工具栏上的 那个小锁，就可以编辑查询的数据了，然后点击对号，再去工具栏提交事务就OK了；</p>
<h1 id="方法2："><a href="#方法2：" class="headerlink" title="方法2："></a>方法2：</h1><p>比如不想查rowid  可以使用for update 然后在编辑</p>
<p>比如sql语句：select * from Table t</p>
<p>改为： select * from Table t for update</p>
<p>查询后 点击查询结果工具栏上的 那个小锁，就可以编辑查询的数据了，然后点击对号，再去工具栏提交事务就OK了；</p>
<h1 id="PS："><a href="#PS：" class="headerlink" title="PS："></a>PS：</h1><p>仔细看的话，会发现二者是有区别的，前者是当点击小锁，修改之后再点击对号，事务的提交和回滚按钮才亮。</p>
<p>而后者是执行完for update的sql，事务的提交和回滚按钮就亮了，这样做的话就会锁住记录，除非你的操作完成后手动提交或者回滚，</p>
<p>否则其他的所有操作都处于等待状态，不推荐。</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>推荐前者，只有当点击对号才去锁记录。select t.*,rowid from Table t;</p>
]]></content>
      <tags>
        <tag>plsql</tag>
        <tag>oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>spring boot 上传文件大小限制</title>
    <url>/posts/2019-09-06/33846/</url>
    <content><![CDATA[<h1 id="spring-boot-上传文件大小限制"><a href="#spring-boot-上传文件大小限制" class="headerlink" title="spring boot 上传文件大小限制"></a>spring boot 上传文件大小限制</h1><h3 id="Spring-Boot-1-3-x"><a href="#Spring-Boot-1-3-x" class="headerlink" title="Spring Boot 1.3.x"></a>Spring Boot 1.3.x</h3><ul>
<li><code>multipart.maxFileSize</code></li>
<li><code>multipart.maxRequestSize</code></li>
</ul>
<h3 id="Spring-Boot-1-4-x-and-1-5-x"><a href="#Spring-Boot-1-4-x-and-1-5-x" class="headerlink" title="Spring Boot 1.4.x and 1.5.x"></a>Spring Boot 1.4.x and 1.5.x</h3><ul>
<li><code>spring.http.multipart.maxFileSize</code></li>
<li><code>spring.http.multipart.maxRequestSize</code></li>
</ul>
<h3 id="Spring-Boot-2-x"><a href="#Spring-Boot-2-x" class="headerlink" title="Spring Boot 2.x"></a>Spring Boot 2.x</h3><span id="more"></span>
<ul>
<li><code>spring.servlet.multipart.maxFileSize</code></li>
<li><code>spring.servlet.multipart.maxRequestSize</code></li>
</ul>
<p>下面是2.x的示例</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Single file max size</span></span><br><span class="line"><span class="attr">spring</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">servlet</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">multipart</span>:<span class="string"></span></span><br><span class="line">      <span class="attr">max-file-size</span>: <span class="string">10MB</span></span><br><span class="line">      <span class="attr">max-request-size</span>: <span class="string">100MB</span></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>spring boot</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 包管理器 Scoop (一)</title>
    <url>/posts/2021-06-09/15670/</url>
    <content><![CDATA[<h2 id="参考地址"><a href="#参考地址" class="headerlink" title="参考地址"></a>参考地址</h2><ul>
<li>Scoop <a href="https://scoop.sh/">[官网地址]</a></li>
<li>Github <a href="https://github.com/lukesampson/scoop">[地址]</a></li>
</ul>
<h2 id="自定义当前用户安装路径与全局安装路径"><a href="#自定义当前用户安装路径与全局安装路径" class="headerlink" title="自定义当前用户安装路径与全局安装路径"></a>自定义当前用户安装路径与全局安装路径</h2><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$env:SCOOP</span>=<span class="string">&#x27;D:\Java\Scoop&#x27;</span></span><br><span class="line">[<span class="type">Environment</span>]::SetEnvironmentVariable(<span class="string">&#x27;SCOOP&#x27;</span>, <span class="variable">$env:SCOOP</span>, <span class="string">&#x27;User&#x27;</span>)</span><br><span class="line"><span class="variable">$env:SCOOP_GLOBAL</span>=<span class="string">&#x27;D:\Java\ScoopGlobalApps&#x27;</span></span><br><span class="line">[<span class="type">Environment</span>]::SetEnvironmentVariable(<span class="string">&#x27;SCOOP_GLOBAL&#x27;</span>, <span class="variable">$env:SCOOP_GLOBAL</span>, <span class="string">&#x27;Machine&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Scoop-安装"><a href="#Scoop-安装" class="headerlink" title="Scoop 安装"></a>Scoop 安装<span id="more"></span></h2><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 设置当前用户安全策略</span></span><br><span class="line"><span class="variable">$</span> <span class="built_in">set-executionpolicy</span> remotesigned <span class="literal">-s</span> cu</span><br><span class="line"><span class="comment"># 安装 scoop</span></span><br><span class="line"><span class="variable">$</span> <span class="built_in">iwr</span> <span class="literal">-useb</span> get.scoop.sh | <span class="built_in">iex</span></span><br></pre></td></tr></table></figure>

<div class="note info"><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>如果安装失败，那就是需要<strong>使用互联网</strong><br>没有使用互联网，你将寸步难行</p>
</div>  

<h2 id="Scoop配置"><a href="#Scoop配置" class="headerlink" title="Scoop配置"></a>Scoop配置</h2><p>本地代理加速 -&gt; 🐱</p>
<figure class="highlight powershell"><figcaption><span>使用代理</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop config proxy <span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">1080</span></span><br></pre></td></tr></table></figure>

<h2 id="Scoop-常用命令"><a href="#Scoop-常用命令" class="headerlink" title="Scoop 常用命令"></a>Scoop 常用命令</h2><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 搜索</span></span><br><span class="line"><span class="variable">$</span> scoop search xxx</span><br><span class="line"><span class="comment"># 当前用户安装 </span></span><br><span class="line"><span class="variable">$</span> scoop install xxx</span><br><span class="line"><span class="comment"># 全局安装</span></span><br><span class="line"><span class="variable">$</span> scoop install <span class="literal">-g</span> xxx</span><br><span class="line"><span class="comment"># 安装列表</span></span><br><span class="line"><span class="variable">$</span> scoop list</span><br><span class="line"><span class="comment"># 更新</span></span><br><span class="line"><span class="variable">$</span> scoop update</span><br><span class="line"><span class="comment"># 更新当前用户已安装app</span></span><br><span class="line"><span class="variable">$</span> scoop update *</span><br><span class="line"><span class="comment"># 更新全局已安装app</span></span><br><span class="line"><span class="variable">$</span> scoop update * <span class="literal">-g</span></span><br><span class="line"><span class="comment"># 更新全局已安装指定app</span></span><br><span class="line"><span class="variable">$</span> scoop update git <span class="literal">-g</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>我自己本地统一按照全局进行安装</p>
</blockquote>
<h2 id="Scoop-配置"><a href="#Scoop-配置" class="headerlink" title="Scoop 配置"></a>Scoop 配置</h2><h3 id="Scoop-下载加速与断点续传-aria2-安装"><a href="#Scoop-下载加速与断点续传-aria2-安装" class="headerlink" title="Scoop 下载加速与断点续传: aria2 安装"></a>Scoop 下载加速与断点续传: aria2 安装</h3><figure class="highlight powershell"><figcaption><span>aria2 安装</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment"># aira2 依赖 7zip git</span></span><br><span class="line"><span class="variable">$</span> scoop install <span class="literal">-g</span> <span class="number">7</span>zip git</span><br><span class="line"><span class="variable">$</span> scoop install <span class="literal">-g</span> aria2</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><figcaption><span>aria2 配置</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop config aria2<span class="literal">-enabled</span> true</span><br><span class="line"><span class="variable">$</span> scoop config aria2<span class="literal">-retry-wait</span> <span class="number">8</span></span><br><span class="line"><span class="variable">$</span> scoop config aria2<span class="literal">-max-connection-per-server</span> <span class="number">16</span></span><br><span class="line"><span class="variable">$</span> scoop config aria2<span class="operator">-split</span> <span class="number">16</span></span><br><span class="line"><span class="variable">$</span> scoop config aria2<span class="literal">-min-split-size</span> <span class="number">2</span>M</span><br><span class="line"><span class="variable">$</span> scoop config aria2<span class="literal">-warning-enabled</span> false</span><br></pre></td></tr></table></figure>

<h3 id="Saccop-搜索加速-scoop-search-安装"><a href="#Saccop-搜索加速-scoop-search-安装" class="headerlink" title="Saccop 搜索加速: scoop-search 安装"></a>Saccop 搜索加速: scoop-search 安装</h3><figure class="highlight powershell"><figcaption><span>scoop-search 安装</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop install <span class="literal">-g</span> scoop<span class="literal">-search</span></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><figcaption><span>scoop-search 使用，提速非常明显</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop<span class="literal">-search</span> <span class="number">7</span>zip</span><br><span class="line"><span class="string">&#x27;main&#x27;</span> bucket:              </span><br><span class="line">    <span class="number">7</span>zip (<span class="number">22.01</span>)            </span><br><span class="line">    <span class="number">7</span>zip19.<span class="number">00</span><span class="literal">-helper</span> (<span class="number">19.00</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Scoop-备份"><a href="#Scoop-备份" class="headerlink" title="Scoop 备份"></a>Scoop 备份</h2><figure class="highlight powershell"><figcaption><span>导出已安装app到指定文件</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop export &gt; .\scoop.export.txt</span><br></pre></td></tr></table></figure>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2021-06-09/15670/">Windows 包管理器 Scoop (一)</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-08-30/34311/">Windows 包管理器 Scoop (二)</a></li></ul></div>
]]></content>
      <tags>
        <tag>scoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 包管理器 Scoop (二)</title>
    <url>/posts/2022-08-30/34311/</url>
    <content><![CDATA[<blockquote>
<p>上一篇进行了 Scoop 的简单安装与基础加速配置，这一篇说一下一些其他高级配置。</p>
</blockquote>
<h2 id="Bucket"><a href="#Bucket" class="headerlink" title="Bucket"></a>Bucket</h2><blockquote>
<p>Scoop 安装后默认自带 “main” bucket，如果你想安装其他工具，可以扩展安装 bucket，bucket 有官方维护也有个人维护。</p>
</blockquote>
<span id="more"></span>
<h3 id="查看官方维护bucket"><a href="#查看官方维护bucket" class="headerlink" title="查看官方维护bucket"></a>查看官方维护bucket</h3><p><a href="https://github.com/ScoopInstaller/Awesome">[点我直达]</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Main OFFICIAL</span><br><span class="line">Extras OFFICIAL</span><br><span class="line">Java OFFICIAL</span><br><span class="line">Versions OFFICIAL</span><br><span class="line">Nonportable OFFICIAL</span><br><span class="line">PHP OFFICIAL</span><br><span class="line">Nightlies OFFICIAL (Deprecated)</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><figcaption><span>通过命令行查看哪些可以直接安装</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop bucket known</span><br><span class="line">main</span><br><span class="line">extras</span><br><span class="line">versions</span><br><span class="line">nirsoft</span><br><span class="line">php</span><br><span class="line">nerd<span class="literal">-fonts</span></span><br><span class="line">nonportable</span><br><span class="line">java</span><br><span class="line">games</span><br></pre></td></tr></table></figure>

<h3 id="安装官方-known-bucket"><a href="#安装官方-known-bucket" class="headerlink" title="安装官方 known bucket"></a>安装官方 known bucket</h3><figure class="highlight powershell"><figcaption><span>快速安装</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment"># main bucket自带，如果你需要重新安装，命令：scoop bucket add main</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add extras</span><br><span class="line"><span class="variable">$</span> scoop bucket add java</span><br><span class="line"><span class="variable">$</span> scoop bucket add nerd<span class="literal">-fonts</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add nirsoft</span><br><span class="line"><span class="variable">$</span> scoop bucket add nonportable</span><br><span class="line"><span class="variable">$</span> scoop bucket add versions</span><br></pre></td></tr></table></figure>

<blockquote>
<p>以上bucket都是官方known，所以可以快速安装，完整命令如下格式</p>
</blockquote>
<figure class="highlight powershell"><figcaption><span>等同于下面完整命令</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment"># main bucket自带，如果你需要重新安装，命令：scoop bucket add main https://github.com/ScoopInstaller/Main</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add extras https://github.com/ScoopInstaller/Extras</span><br><span class="line"><span class="variable">$</span> scoop bucket add java https://github.com/ScoopInstaller/Java</span><br><span class="line"><span class="variable">$</span> scoop bucket add nerd<span class="literal">-fonts</span> https://github.com/matthewjberger/scoop<span class="literal">-nerd-fonts</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add nirsoft https://github.com/kodybrown/scoop<span class="literal">-nirsoft</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add nonportable https://github.com/ScoopInstaller/Nonportable</span><br><span class="line"><span class="variable">$</span> scoop bucket add versions https://github.com/ScoopInstaller/Versions</span><br></pre></td></tr></table></figure>
<div class="note info"><h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><p>如果你需要加速，则把上面的 “<a href="https://github.com/">https://github.com</a>“ 替换为 “<a href="https://hub.fastgit.xyz/">https://hub.fastgit.xyz</a>“<br>参考链接 <a href="https://doc.fastgit.org/zh-cn/guide.html"><strong>FastGit</strong></a></p>
</div>

<h3 id="安装其他bucket"><a href="#安装其他bucket" class="headerlink" title="安装其他bucket"></a>安装其他bucket</h3><figure class="highlight powershell"><figcaption><span>推荐安装前两个</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop bucket add dorado https://github.com/chawyehsu/dorado</span><br><span class="line"><span class="variable">$</span> scoop bucket add scoopcn https://github.com/scoopcn/scoopcn</span><br><span class="line"><span class="comment"># 如果你需要一个scoop的gui，那你可以添加下面这个，然后scoop install scoop-viewer</span></span><br><span class="line"><span class="comment"># 启动方式 &quot;scoop gui&quot; 或 &quot;scoopviewer&quot;</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add scoop<span class="literal">-viewer-bucket</span> https://github.com/prezesp/scoop<span class="literal">-viewer-bucket</span>.git</span><br><span class="line"><span class="comment"># 如果你知道rsocket，并且需要使用rsc，可以添加下面这个，然后 scoop install rsc</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add making https://github.com/making/scoop<span class="literal">-bucket</span>.git</span><br></pre></td></tr></table></figure>

<h3 id="多合一bucket"><a href="#多合一bucket" class="headerlink" title="多合一bucket"></a>多合一bucket</h3><p>最近发现一个宝藏，这个bucket是对其他大部分常用bucket（除main之外）的整合，并且会及时更新</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop bucket add apps https://github.com/kkzzhizhou/scoop<span class="literal">-apps</span></span><br><span class="line"><span class="comment"># 你也可以使用下面这种加速方式</span></span><br><span class="line"><span class="variable">$</span> scoop bucket add apps https://hub.fastgit.xyz/kkzzhizhou/scoop<span class="literal">-apps</span></span><br></pre></td></tr></table></figure>

<h2 id="个人使用命令行集合"><a href="#个人使用命令行集合" class="headerlink" title="个人使用命令行集合"></a>个人使用命令行集合</h2><ul>
<li>maven</li>
<li>python</li>
<li>redis</li>
<li>nodejs</li>
<li>openjdk 当前版本 18.*</li>
<li>openjdk17 当前版本 17.*</li>
<li>openjdk11 版本 11.*</li>
<li>zulu8-jdk 当前版本 1.8.*</li>
<li>rsc RSocket cli</li>
<li>JetBrains-Mono 开源字体，世界上最好的编程字体</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scoop install -g 7zip git</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scoop install -g sudo aria2 curl grep maven nodejs openjdk openjdk11 openjdk17</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scoop install -g openssl-light python redis scoop-search scoop-viewer zulu8-jdk</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scoop install -g rsc JetBrains-Mono</span></span><br></pre></td></tr></table></figure>
<h2 id="个人使用GUI集合"><a href="#个人使用GUI集合" class="headerlink" title="个人使用GUI集合"></a>个人使用GUI集合</h2><ul>
<li>another-redis-desktop-manager redis客户端</li>
<li>apifox 接口测试</li>
<li>🐱-for-windows 科学上网</li>
<li>draw.io 开源画图工具</li>
<li>marktext 免费markdown，typora 收费（from1.*） markdown</li>
<li>notepadplusplus 作者台独，白嫖使用来抵制</li>
<li>picgo 图床工具</li>
<li>quicklook 空格预览 <ul>
<li>quicklook 插件<a href="https://github.com/QL-Win/QuickLook/wiki/Available-Plugins">https://github.com/QL-Win/QuickLook/wiki/Available-Plugins</a></li>
</ul>
</li>
<li>sunlogin todesk 远程桌面</li>
<li>treesize-free wiztree 磁盘占用查看</li>
<li>utools 程序员必备</li>
<li>wps wps</li>
<li>yuque 语雀</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scoop install -g another-redis-desktop-manager apifox clash-可能包含违禁违规内容<span class="keyword">for</span>请排查调整后再行重试-windows</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scoop install -g draw.io marktext notepadplusplus picgo quicklook sunlogin</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scoop install -g todesk treesize-free typora utools wiztree wps yuque</span></span><br></pre></td></tr></table></figure>

<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2021-06-09/15670/">Windows 包管理器 Scoop (一)</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-08-30/34311/">Windows 包管理器 Scoop (二)</a></li></ul></div>
]]></content>
      <tags>
        <tag>scoop</tag>
      </tags>
  </entry>
  <entry>
    <title>我的面试</title>
    <url>/posts/2024-08-02/13593/</url>
    <content><![CDATA[<h2 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h2><blockquote>
<p>浑浑噩噩工作了这么多年，没什么积累，也没什么建树，不知道未来的方向，更没有朝着某个方向努力。慢慢写，慢慢积累！</p>
</blockquote>
<span id="more"></span>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><ul>
<li>聚簇索引为什么这么设计？为什么使用B+树，和B树红黑树什么区别？</li>
</ul>
<h3 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h3><ul>
<li>autoconfig 怎么生效的？</li>
</ul>
<h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><p>cglib 代理和 jvm 动态代理什么区别？</p>
]]></content>
      <categories>
        <category>杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>WebSocket（一）Server 简单搭建</title>
    <url>/posts/2022-07-12/43222/</url>
    <content><![CDATA[<h1 id="Maven-依赖"><a href="#Maven-依赖" class="headerlink" title="Maven 依赖"></a>Maven 依赖</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang3<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.java-websocket<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Java-WebSocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="核心配置"><a href="#核心配置" class="headerlink" title="核心配置"></a>核心配置</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.server.standard.ServerEndpointExporter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketConfig</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 注入一个ServerEndpointExporter,该Bean会自动注册使用<span class="doctag">@ServerEndpoint</span>注解申明的websocket endpoint</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="keyword">public</span> ServerEndpointExporter <span class="title function_">serverEndpointExporter</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServerEndpointExporter</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.websocket.*;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.ServerEndpoint;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ServerEndpoint(value = &quot;/demo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketDemo</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 记录当前在线连接数</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">onlineCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 连接建立成功调用的方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="meta">@OnOpen</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOpen</span><span class="params">(Session session)</span> &#123;</span><br><span class="line">    onlineCount.incrementAndGet();</span><br><span class="line">    log.info(<span class="string">&quot;有新连接加入：&#123;&#125;，当前在线人数为：&#123;&#125;&quot;</span>, session.getId(), onlineCount.get());</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 连接关闭调用的方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="meta">@OnClose</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClose</span><span class="params">(Session session)</span> &#123;</span><br><span class="line">    onlineCount.decrementAndGet();</span><br><span class="line">    log.info(<span class="string">&quot;有一连接关闭：&#123;&#125;，当前在线人数为：&#123;&#125;&quot;</span>, session.getId(), onlineCount.get());</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 收到客户端消息后调用的方法</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> message 客户端发送过来的消息</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="meta">@OnMessage</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(String message, Session session)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;服务端收到客户端[&#123;&#125;]的消息:&#123;&#125;&quot;</span>, session.getId(), message);</span><br><span class="line">    <span class="built_in">this</span>.sendMessage(<span class="string">&quot;Hello, &quot;</span> + message, session);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@OnError</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Session session, Throwable error)</span> &#123;</span><br><span class="line">    log.error(<span class="string">&quot;发生错误&quot;</span>);</span><br><span class="line">    error.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 服务端发送消息给客户端</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(String message, Session toSession)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      log.info(<span class="string">&quot;服务端给客户端[&#123;&#125;]发送消息&#123;&#125;&quot;</span>, toSession.getId(), message);</span><br><span class="line">      toSession.getBasicRemote().sendText(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      log.error(<span class="string">&quot;服务端发送消息给客户端失败：&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h1><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9716</span></span><br></pre></td></tr></table></figure>

<h1 id="准备测试"><a href="#准备测试" class="headerlink" title="准备测试"></a>准备测试</h1><p><strong>文件路径：src\main\resources\static\index.html</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My WebSocket<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;text&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;send()&quot;</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;closeWebSocket()&quot;</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;message&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> websocket = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//判断当前浏览器是否支持WebSocket, 主要此处要更换为自己的地址</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (<span class="string">&#x27;WebSocket&#x27;</span> <span class="keyword">in</span> <span class="variable language_">window</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        websocket = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&quot;ws://localhost:9716/demo&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&#x27;Not support websocket&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//连接发生错误的回调方法</span></span></span><br><span class="line"><span class="language-javascript">    websocket.<span class="property">onerror</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setMessageInnerHTML</span>(<span class="string">&quot;error&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//连接成功建立的回调方法</span></span></span><br><span class="line"><span class="language-javascript">    websocket.<span class="property">onopen</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//setMessageInnerHTML(&quot;open&quot;);</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//接收到消息的回调方法</span></span></span><br><span class="line"><span class="language-javascript">    websocket.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setMessageInnerHTML</span>(event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//连接关闭的回调方法</span></span></span><br><span class="line"><span class="language-javascript">    websocket.<span class="property">onclose</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setMessageInnerHTML</span>(<span class="string">&quot;close&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="property">onbeforeunload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        websocket.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//将消息显示在网页上</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">setMessageInnerHTML</span>(<span class="params">innerHTML</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;message&#x27;</span>).<span class="property">innerHTML</span> += innerHTML + <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//关闭连接</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">closeWebSocket</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        websocket.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//发送消息</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">send</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> message = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;text&#x27;</span>).<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">        websocket.<span class="title function_">send</span>(message);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p><a href="http://localhost:9716/">http://localhost:9716/</a><br><img src="http://cdn.jackkke.top/blog/images/20220830120046.png" alt="image.png"></p>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/43222/">WebSocket（一）Server 简单搭建</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/9287/">WebSocket（二）Client 简单实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（三）Client 同步实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（四）连接池</a></li></ul></div>]]></content>
      <categories>
        <category>websocket</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>websocket</tag>
      </tags>
  </entry>
  <entry>
    <title>WebSocket（二）Client 简单实现</title>
    <url>/posts/2022-07-12/9287/</url>
    <content><![CDATA[<h1 id="Client-简单实现"><a href="#Client-简单实现" class="headerlink" title="Client 简单实现"></a>Client 简单实现</h1><p>继承 WebSocketClient ，增加自定义参数，增加回调函数支持</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.client.WebSocketClient;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.drafts.Draft;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.drafts.Draft_6455;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.handshake.ServerHandshake;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> java.net.URISyntaxException;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DefaultWebSocketClient</span> <span class="keyword">extends</span> <span class="title class_">WebSocketClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">connectTimeout</span> <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Draft</span> <span class="variable">protocolDraft</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Draft_6455</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, String&gt; httpHeaders = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> Consumer&lt;String&gt; callString;</span><br><span class="line">    <span class="keyword">private</span> Consumer&lt;ByteBuffer&gt; callByte;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(String serverUri, Consumer&lt;String&gt; callString)</span> <span class="keyword">throws</span> URISyntaxException &#123;</span><br><span class="line">        <span class="built_in">this</span>(<span class="keyword">new</span> <span class="title class_">URI</span>(serverUri));</span><br><span class="line">        <span class="built_in">this</span>.callString = callString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(Consumer&lt;ByteBuffer&gt; callByte, String serverUri)</span> <span class="keyword">throws</span> URISyntaxException &#123;</span><br><span class="line">        <span class="built_in">this</span>(<span class="keyword">new</span> <span class="title class_">URI</span>(serverUri));</span><br><span class="line">        <span class="built_in">this</span>.callByte = callByte;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(String serverUri, Map&lt;String, String&gt; httpHeaders)</span> <span class="keyword">throws</span> URISyntaxException &#123;</span><br><span class="line">        <span class="built_in">this</span>(<span class="keyword">new</span> <span class="title class_">URI</span>(serverUri), httpHeaders);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(URI serverUri)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(URI serverUri, Draft protocolDraft)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft, httpHeaders);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(URI serverUri, Map&lt;String, String&gt; httpHeaders)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft, httpHeaders);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(URI serverUri, Draft protocolDraft, Map&lt;String, String&gt; httpHeaders)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft, httpHeaders, connectTimeout);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultWebSocketClient</span><span class="params">(URI serverUri, Draft protocolDraft, Map&lt;String, String&gt; httpHeaders, <span class="type">int</span> connectTimeout)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(serverUri, protocolDraft, httpHeaders, connectTimeout);</span><br><span class="line">        log.debug(<span class="string">&quot;构建 DefaultWebSocketClient&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\tURI:     &#123;&#125;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\tDraft:   &#123;&#125;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\tHeaders: &#123;&#125;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\ttimeOut: &#123;&#125;&quot;</span>, serverUri, protocolDraft, httpHeaders, connectTimeout);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOpen</span><span class="params">(ServerHandshake handshakedata)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onOpen…………&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onMessage…………&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;result &#123;&#125;&quot;</span>, message);</span><br><span class="line">        <span class="keyword">if</span> (callString != <span class="literal">null</span>) &#123;</span><br><span class="line">            callString.accept(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(ByteBuffer message)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onMessage-bytes…………&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;result &#123;&#125;&quot;</span>, message);</span><br><span class="line">        <span class="keyword">if</span> (callByte != <span class="literal">null</span>) &#123;</span><br><span class="line">            callByte.accept(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClose</span><span class="params">(<span class="type">int</span> code, String reason, <span class="type">boolean</span> remote)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onClose…………&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Exception ex)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onError………… &#123;&#125;&quot;</span>, ex.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URISyntaxException;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Consumer&lt;String&gt; consumer = Test::call;</span><br><span class="line">            <span class="type">DefaultWebSocketClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultWebSocketClient</span>(</span><br><span class="line">                    <span class="string">&quot;ws://localhost:9716/demo&quot;</span>,</span><br><span class="line">                    consumer</span><br><span class="line">            );</span><br><span class="line">            client.connectBlocking();</span><br><span class="line">            client.send(<span class="string">&quot;我来了&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (URISyntaxException | InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;text</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">call</span><span class="params">(String ss)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ss = &quot;</span> + ss);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="控制台输出结果"><a href="#控制台输出结果" class="headerlink" title="控制台输出结果"></a>控制台输出结果</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">17:21:51.830 [main] DEBUG com.example.demo.client.DefaultWebSocketClient - 构建 DefaultWebSocketClient</span><br><span class="line">	URI:     ws://localhost:9716/demo</span><br><span class="line">	Draft:   Draft_6455 extension: DefaultExtension max frame size: 2147483647</span><br><span class="line">	Headers: &#123;&#125;</span><br><span class="line">	timeOut: 2000</span><br><span class="line">17:21:52.069 [WebSocketConnectReadThread-12] DEBUG com.example.demo.client.DefaultWebSocketClient - onOpen…………</span><br><span class="line">17:21:52.099 [WebSocketConnectReadThread-12] DEBUG com.example.demo.client.DefaultWebSocketClient - onMessage…………</span><br><span class="line">17:21:52.099 [WebSocketConnectReadThread-12] INFO com.example.demo.client.DefaultWebSocketClient - result Hello, 我来了</span><br><span class="line">ss = Hello, 我来了</span><br></pre></td></tr></table></figure>

<h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><blockquote>
<p>如果你使用单元测试可能会报错，在注解后面增加以下代码即可<br>SpringBootTest在启动的时候不会启动服务器，所以WebSocket自然会报错。<br>这个时候需要添加选项webEnvironment，以便提供一个测试的web环境。<br>@SpringBootTest(webEnvironment &#x3D; SpringBootTest.WebEnvironment.<strong><em>DEFINED_PORT</em></strong>)</p>
</blockquote>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/43222/">WebSocket（一）Server 简单搭建</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/9287/">WebSocket（二）Client 简单实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（三）Client 同步实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（四）连接池</a></li></ul></div>]]></content>
      <categories>
        <category>websocket</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>websocket</tag>
      </tags>
  </entry>
  <entry>
    <title>WebSocket（三）Client 同步实现</title>
    <url>/posts/2022-07-12/56021/</url>
    <content><![CDATA[<h1 id="Client-同步实现"><a href="#Client-同步实现" class="headerlink" title="Client 同步实现"></a>Client 同步实现</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.client.WebSocketClient;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.drafts.Draft;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.drafts.Draft_6455;</span><br><span class="line"><span class="keyword">import</span> org.java_websocket.handshake.ServerHandshake;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> java.net.URISyntaxException;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DefaultSyncWebSocketClient</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">WebSocketClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">connectTimeout</span> <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Draft</span> <span class="variable">protocolDraft</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Draft_6455</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, String&gt; httpHeaders = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">CountDownLatch</span> <span class="variable">downLatch</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultSyncWebSocketClient</span><span class="params">(String serverUri)</span> <span class="keyword">throws</span> URISyntaxException &#123;</span><br><span class="line">        <span class="built_in">this</span>(<span class="keyword">new</span> <span class="title class_">URI</span>(serverUri));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultSyncWebSocketClient</span><span class="params">(String serverUri, Map&lt;String, String&gt; httpHeaders)</span> <span class="keyword">throws</span> URISyntaxException &#123;</span><br><span class="line">        <span class="built_in">this</span>(<span class="keyword">new</span> <span class="title class_">URI</span>(serverUri), httpHeaders);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultSyncWebSocketClient</span><span class="params">(URI serverUri)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultSyncWebSocketClient</span><span class="params">(URI serverUri, Draft protocolDraft)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft, httpHeaders);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultSyncWebSocketClient</span><span class="params">(URI serverUri, Map&lt;String, String&gt; httpHeaders)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft, httpHeaders);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultSyncWebSocketClient</span><span class="params">(URI serverUri, Draft protocolDraft, Map&lt;String, String&gt; httpHeaders)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(serverUri, protocolDraft, httpHeaders, connectTimeout);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DefaultSyncWebSocketClient</span><span class="params">(URI serverUri, Draft protocolDraft, Map&lt;String, String&gt; httpHeaders, <span class="type">int</span> connectTimeout)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(serverUri, protocolDraft, httpHeaders, connectTimeout);</span><br><span class="line">        log.debug(<span class="string">&quot;构建 DefaultWebSocketClient&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\tURI:     &#123;&#125;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\tDraft:   &#123;&#125;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\tHeaders: &#123;&#125;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\n\ttimeOut: &#123;&#125;&quot;</span>, serverUri, protocolDraft, httpHeaders, connectTimeout);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">sendExt</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> RuntimeException &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;sendExt…………&quot;</span>);</span><br><span class="line">        <span class="keyword">synchronized</span> (lock)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                downLatch = <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">                    send((String) obj);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="type">byte</span>[])&#123;</span><br><span class="line">                    send((<span class="type">byte</span>[]) obj);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;不支持的参数类型&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                downLatch.await();</span><br><span class="line">                <span class="keyword">return</span> (T) result;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                log.error(<span class="string">&quot;连接异常中断 &#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;连接异常中断&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOpen</span><span class="params">(ServerHandshake handshakedata)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onOpen…………&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onMessage…………&quot;</span>);</span><br><span class="line">        result = message;</span><br><span class="line">        <span class="keyword">if</span>(downLatch!=<span class="literal">null</span>)&#123;</span><br><span class="line">            downLatch.countDown();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(ByteBuffer bytes)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onMessage-bytes…………&quot;</span>);</span><br><span class="line">        result = bytes;</span><br><span class="line">        <span class="keyword">if</span>(downLatch!=<span class="literal">null</span>)&#123;</span><br><span class="line">            downLatch.countDown();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClose</span><span class="params">(<span class="type">int</span> code, String reason, <span class="type">boolean</span> remote)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onClose…………&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Exception ex)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;onError………… &#123;&#125;&quot;</span>, ex.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URISyntaxException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSync</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            DefaultSyncWebSocketClient&lt;String&gt; client = <span class="keyword">new</span> <span class="title class_">DefaultSyncWebSocketClient</span>&lt;&gt;(<span class="string">&quot;ws://localhost:9716/demo&quot;</span>);</span><br><span class="line">            client.connectBlocking();</span><br><span class="line">            <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> client.sendExt(<span class="string">&quot;我来了&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;result = &quot;</span> + result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (URISyntaxException | InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="控制台输出结果"><a href="#控制台输出结果" class="headerlink" title="控制台输出结果"></a>控制台输出结果</h1><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line">17:33:03.904 [main] DEBUG com.example.demo.client.DefaultSyncWebSocketClient - 构建 DefaultWebSocketClient</span><br><span class="line">	URI:     ws://localhost:9716/demo</span><br><span class="line">	Draft:   Draft<span class="built_in">_</span>6455 extension: DefaultExtension max frame size: 2147483647</span><br><span class="line">	Headers: &#123;&#125;</span><br><span class="line">	timeOut: 2000</span><br><span class="line">17:33:04.088 [WebSocketConnectReadThread-12] DEBUG com.example.demo.client.DefaultSyncWebSocketClient - onOpen…………</span><br><span class="line">17:33:04.088 [main] DEBUG com.example.demo.client.DefaultSyncWebSocketClient - sendExt…………</span><br><span class="line">17:33:04.092 [WebSocketConnectReadThread-12] DEBUG com.example.demo.client.DefaultSyncWebSocketClient - onMessage…………</span><br><span class="line">result = Hello, 我来了</span><br><span class="line">17:33:04.093 [WebSocketConnectReadThread-12] DEBUG com.example.demo.client.DefaultSyncWebSocketClient - onClose…………</span><br></pre></td></tr></table></figure>

<h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><blockquote>
<p>如果你使用单元测试可能会报错，在注解后面增加以下代码即可<br>SpringBootTest在启动的时候不会启动服务器，所以WebSocket自然会报错。<br>这个时候需要添加选项webEnvironment，以便提供一个测试的web环境。<br>@SpringBootTest(webEnvironment &#x3D; SpringBootTest.WebEnvironment.<strong><em>DEFINED_PORT</em></strong>)</p>
</blockquote>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/43222/">WebSocket（一）Server 简单搭建</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/9287/">WebSocket（二）Client 简单实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（三）Client 同步实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（四）连接池</a></li></ul></div>]]></content>
      <categories>
        <category>websocket</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>websocket</tag>
      </tags>
  </entry>
  <entry>
    <title>WebSocket（四）连接池</title>
    <url>/posts/2022-07-12/56021/</url>
    <content><![CDATA[<p>😜<br>&#x2F;&#x2F; TODO</p>
<div class="post-series"><div class="post-series-title">系列文章</div><ul class="post-series-list"><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/43222/">WebSocket（一）Server 简单搭建</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/9287/">WebSocket（二）Client 简单实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（三）Client 同步实现</a></li><li class="post-series-list-item"><a href="https://jackkke.github.io/posts/2022-07-12/56021/">WebSocket（四）连接池</a></li></ul></div>]]></content>
      <categories>
        <category>websocket</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>websocket</tag>
      </tags>
  </entry>
</search>
